<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èº«ä»½ä¿¡æ¯ç”Ÿæˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-top: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
        }

        .result-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .export-buttons {
            display: none;
            gap: 10px;
            margin-top: 20px;
        }

        .export-buttons button {
            flex: 1;
        }

        #regionGroup, #foreignerVersionGroup, #hkmacaoRegionGroup {
            display: none;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        .age-unit-group {
            display: flex;
            gap: 10px;
        }

        .age-unit-group input {
            flex: 1;
        }

        .age-unit-group select {
            width: 100px;
        }

        .date-input-group {
            display: none;
            margin-top: 10px;
        }

        .tab-buttons {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
        }

        .tab-button {
            padding: 10px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            transition: background-color 0.3s;
        }

        .tab-button.active {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ­ èº«ä»½ä¿¡æ¯ç”Ÿæˆå™¨</h1>
        
        <div class="warning">
            âš ï¸ <strong>é‡è¦æç¤ºï¼š</strong>æœ¬å·¥å…·ç”Ÿæˆçš„æ‰€æœ‰æ•°æ®å‡ä¸ºè™šæ‹Ÿæ•°æ®ï¼Œä»…ä¾›å¼€å‘æµ‹è¯•ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºä»»ä½•éæ³•ç”¨é€”ï¼
        </div>

        <!-- å•ä¸ªç”Ÿæˆ -->
        <div class="card">
            <h2>å•ä¸ªç”Ÿæˆ</h2>
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('ageRange')">æŒ‰å¹´é¾„èŒƒå›´ç”Ÿæˆ</button>
                <button class="tab-button" onclick="switchTab('specificDate')">æŒ‰å…·ä½“æ—¥æœŸç”Ÿæˆ</button>
            </div>

            <div class="row">
                <div class="form-group">
                    <label for="docType">è¯ä»¶ç±»å‹</label>
                    <select id="docType">
                        <option value="idcard">ä¸­å›½å¤§é™†èº«ä»½è¯</option>
                        <option value="residence">æ¸¯æ¾³å°å±…æ°‘å±…ä½è¯</option>
                        <option value="foreigner">å¤–å›½äººæ°¸ä¹…å±…ç•™è¯</option>
                        <option value="hkmacao">æ¸¯æ¾³é€šè¡Œè¯</option>
                        <option value="taiwan">å°æ¹¾é€šè¡Œè¯</option>
                        <option value="passport">æŠ¤ç…§</option>
                    </select>
                </div>

                <div class="form-group" id="regionGroup">
                    <label for="region">åœ°åŒº</label>
                    <select id="region">
                        <option value="hk">é¦™æ¸¯</option>
                        <option value="macao">æ¾³é—¨</option>
                        <option value="taiwan">å°æ¹¾</option>
                    </select>
                </div>

                <div class="form-group" id="foreignerVersionGroup">
                    <label for="foreignerVersion">å¤–å›½äººæ°¸å±…è¯ç‰ˆæœ¬</label>
                    <select id="foreignerVersion">
                        <option value="new">æ–°ç‰ˆ (18ä½)</option>
                        <option value="old">æ—§ç‰ˆ (15ä½)</option>
                    </select>
                </div>

                <div class="form-group" id="hkmacaoRegionGroup">
                    <label for="hkmacaoRegion">åœ°åŒº</label>
                    <select id="hkmacaoRegion">
                        <option value="hk">é¦™æ¸¯</option>
                        <option value="macao">æ¾³é—¨</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="gender">æ€§åˆ«</label>
                    <select id="gender">
                        <option value="random">éšæœº</option>
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="nameType">å§“åç±»å‹</label>
                    <select id="nameType">
                        <option value="chinese">ä¸­æ–‡</option>
                        <option value="english">è‹±æ–‡</option>
                    </select>
                </div>
            </div>

            <!-- å¹´é¾„èŒƒå›´ç”Ÿæˆ -->
            <div id="ageRangeTab">
                <div class="row">
                    <div class="form-group">
                        <label for="minAge">æœ€å°å¹´é¾„</label>
                        <div class="age-unit-group">
                            <input type="number" id="minAge" value="18" min="0" max="1000">
                            <select id="minAgeUnit">
                                <option value="years">å‘¨å²</option>
                                <option value="days">å¤©</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="maxAge">æœ€å¤§å¹´é¾„</label>
                        <div class="age-unit-group">
                            <input type="number" id="maxAge" value="65" min="0" max="1000">
                            <select id="maxAgeUnit">
                                <option value="years">å‘¨å²</option>
                                <option value="days">å¤©</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…·ä½“æ—¥æœŸç”Ÿæˆ -->
            <div id="specificDateTab" style="display: none;">
                <div class="form-group">
                    <label for="specificDate">å…·ä½“å‡ºç”Ÿæ—¥æœŸ</label>
                    <input type="date" id="specificDate">
                </div>
            </div>

            <!-- é“¶è¡Œå¡ç”Ÿæˆé€‰é¡¹ -->
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="generateBankCard" checked>
                    <label for="generateBankCard">åŒæ—¶ç”Ÿæˆé“¶è¡Œå¡å·</label>
                </div>
            </div>

            <div id="bankCardOptions">
                <div class="row">
                    <div class="form-group">
                        <label for="bankType">é“¶è¡Œç±»å‹</label>
                        <select id="bankType">
                            <option value="icbc">å·¥å•†é“¶è¡Œ</option>
                            <option value="ccb">å»ºè®¾é“¶è¡Œ</option>
                            <option value="abc">å†œä¸šé“¶è¡Œ</option>
                            <option value="boc">ä¸­å›½é“¶è¡Œ</option>
                            <option value="bcm">äº¤é€šé“¶è¡Œ</option>
                            <option value="cmb">æ‹›å•†é“¶è¡Œ</option>
                            <option value="psbc">é‚®å‚¨é“¶è¡Œ</option>
                            <option value="cmbc">æ°‘ç”Ÿé“¶è¡Œ</option>
                            <option value="citic">ä¸­ä¿¡é“¶è¡Œ</option>
                            <option value="ceb">å…‰å¤§é“¶è¡Œ</option>
                            <option value="spdb">æµ¦å‘é“¶è¡Œ</option>
                            <option value="cib">å…´ä¸šé“¶è¡Œ</option>
                            <option value="pingan">å¹³å®‰é“¶è¡Œ</option>
                            <option value="hxb">åå¤é“¶è¡Œ</option>
                            <option value="cgb">å¹¿å‘é“¶è¡Œ</option>
                            <option value="random">éšæœºé“¶è¡Œ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cardSuffix">é“¶è¡Œå¡å°¾å· (2-4ä½)</label>
                        <input type="text" id="cardSuffix" placeholder="ä¾‹å¦‚ï¼š01" maxlength="4">
                    </div>
                </div>
            </div>

            <button onclick="generate()">ç”Ÿæˆ</button>

            <div id="result" class="result"></div>
        </div>

        <!-- æ‰¹é‡ç”Ÿæˆ -->
        <div class="card">
            <h2>æ‰¹é‡ç”Ÿæˆ</h2>
            <div class="row">
                <div class="form-group">
                    <label for="batchDocType">è¯ä»¶ç±»å‹</label>
                    <select id="batchDocType">
                        <option value="idcard">ä¸­å›½å¤§é™†èº«ä»½è¯</option>
                        <option value="residence">æ¸¯æ¾³å°å±…æ°‘å±…ä½è¯</option>
                        <option value="foreigner">å¤–å›½äººæ°¸ä¹…å±…ç•™è¯</option>
                        <option value="hkmacao">æ¸¯æ¾³é€šè¡Œè¯</option>
                        <option value="taiwan">å°æ¹¾é€šè¡Œè¯</option>
                        <option value="passport">æŠ¤ç…§</option>
                    </select>
                </div>

                <div class="form-group" id="batchRegionGroup">
                    <label for="batchRegion">åœ°åŒº</label>
                    <select id="batchRegion">
                        <option value="hk">é¦™æ¸¯</option>
                        <option value="macao">æ¾³é—¨</option>
                        <option value="taiwan">å°æ¹¾</option>
                    </select>
                </div>

                <div class="form-group" id="batchForeignerVersionGroup">
                    <label for="batchForeignerVersion">å¤–å›½äººæ°¸å±…è¯ç‰ˆæœ¬</label>
                    <select id="batchForeignerVersion">
                        <option value="new">æ–°ç‰ˆ (18ä½)</option>
                        <option value="old">æ—§ç‰ˆ (15ä½)</option>
                    </select>
                </div>

                <div class="form-group" id="batchHkmacaoRegionGroup">
                    <label for="batchHkmacaoRegion">åœ°åŒº</label>
                    <select id="batchHkmacaoRegion">
                        <option value="hk">é¦™æ¸¯</option>
                        <option value="macao">æ¾³é—¨</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="batchCount">ç”Ÿæˆæ•°é‡ (1-1000)</label>
                    <input type="number" id="batchCount" value="10" min="1" max="1000">
                </div>
            </div>

            <!-- æ‰¹é‡ç”Ÿæˆé“¶è¡Œå¡é€‰é¡¹ -->
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="batchGenerateBankCard" checked>
                    <label for="batchGenerateBankCard">åŒæ—¶ç”Ÿæˆé“¶è¡Œå¡å·</label>
                </div>
            </div>

            <div id="batchBankCardOptions">
                <div class="row">
                    <div class="form-group">
                        <label for="batchBankType">é“¶è¡Œç±»å‹</label>
                        <select id="batchBankType">
                            <option value="icbc">å·¥å•†é“¶è¡Œ</option>
                            <option value="ccb">å»ºè®¾é“¶è¡Œ</option>
                            <option value="abc">å†œä¸šé“¶è¡Œ</option>
                            <option value="boc">ä¸­å›½é“¶è¡Œ</option>
                            <option value="bcm">äº¤é€šé“¶è¡Œ</option>
                            <option value="cmb">æ‹›å•†é“¶è¡Œ</option>
                            <option value="psbc">é‚®å‚¨é“¶è¡Œ</option>
                            <option value="cmbc">æ°‘ç”Ÿé“¶è¡Œ</option>
                            <option value="citic">ä¸­ä¿¡é“¶è¡Œ</option>
                            <option value="ceb">å…‰å¤§é“¶è¡Œ</option>
                            <option value="spdb">æµ¦å‘é“¶è¡Œ</option>
                            <option value="cib">å…´ä¸šé“¶è¡Œ</option>
                            <option value="pingan">å¹³å®‰é“¶è¡Œ</option>
                            <option value="hxb">åå¤é“¶è¡Œ</option>
                            <option value="cgb">å¹¿å‘é“¶è¡Œ</option>
                            <option value="random">éšæœºé“¶è¡Œ</option>
                        </select>
                    </div>
                </div>
            </div>

            <button onclick="batchGenerate()">æ‰¹é‡ç”Ÿæˆ</button>

            <div id="exportButtons" class="export-buttons">
                <button onclick="exportData('json')">å¯¼å‡ºJSON</button>
                <button onclick="exportData('csv')">å¯¼å‡ºCSV</button>
                <button onclick="exportData('txt')">å¯¼å‡ºTXT</button>
            </div>

            <div id="batchResult" class="result"></div>
        </div>
    </div>

    <script>
        let batchData = [];
        let currentTab = 'ageRange';

        // å¸¸ç”¨å§“æ°
        const surnames = ['ç‹', 'æ', 'å¼ ', 'åˆ˜', 'é™ˆ', 'æ¨', 'é»„', 'èµµ', 'å‘¨', 'å´', 'å¾', 'å­™', 'é©¬', 'æœ±', 'èƒ¡', 'éƒ­', 'ä½•', 'æ—', 'é«˜', 'ç½—', 'éƒ‘', 'æ¢', 'è°¢', 'å®‹', 'å”', 'è®¸', 'éŸ©', 'å†¯', 'é‚“', 'æ›¹', 'å½­', 'æ›¾', 'è‚–', 'ç”°', 'è‘£', 'è¢', 'æ½˜', 'äº', 'è’‹', 'è”¡', 'ä½™', 'æœ', 'å¶', 'ç¨‹', 'è‹', 'é­', 'å•', 'ä¸', 'ä»»', 'æ²ˆ', 'å§š'];

        // å¸¸ç”¨åå­—
        const givenNames = ['ä¼Ÿ', 'èŠ³', 'å¨œ', 'ç§€è‹±', 'æ•', 'é™', 'ä¸½', 'å¼º', 'ç£Š', 'å†›', 'æ´‹', 'å‹‡', 'è‰³', 'æ°', 'å¨Ÿ', 'æ¶›', 'æ˜', 'è¶…', 'ç§€å…°', 'éœ', 'å¹³', 'åˆš', 'æ¡‚è‹±', 'å', 'å»º', 'æ–‡', 'è¾‰', 'åŠ›', 'æ³¢', 'å®', 'é£', 'é¹', 'ç²', 'å¸…', 'ç´', 'é¾™', 'è', 'çº¢', 'å©·', 'äº‘', 'å³°', 'æµ©', 'äº®', 'å®‡', 'ç‡•', 'è‰', 'é‘«', 'å‡¯', 'æ…§', 'ç³'];

        // è‹±æ–‡åå­—
        const englishFirstNames = ['James', 'John', 'Robert', 'Michael', 'William', 'David', 'Richard', 'Joseph', 'Thomas', 'Charles', 'Mary', 'Patricia', 'Jennifer', 'Linda', 'Elizabeth', 'Barbara', 'Susan', 'Jessica', 'Sarah', 'Karen', 'Nancy', 'Lisa', 'Betty', 'Margaret', 'Sandra', 'Ashley', 'Kimberly', 'Emily', 'Donna', 'Michelle'];

        const englishLastNames = ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Wilson', 'Anderson', 'Thomas', 'Taylor', 'Moore', 'Jackson', 'Martin', 'Lee', 'Thompson', 'White', 'Harris', 'Sanchez', 'Clark', 'Ramirez', 'Lewis', 'Robinson', 'Walker'];

        // è¡Œæ”¿åŒºåˆ’ä»£ç 
        const areaCodes = [
            '110101', '110102', '110105', '110106', '110107', '110108', '110109',
            '310101', '310104', '310105', '310106', '310107', '310109', '310110',
            '440103', '440104', '440105', '440106', '440111', '440112', '440113',
            '500101', '500102', '500103', '500104', '500105', '500106', '500107',
            '120101', '120102', '120103', '120104', '120105', '120106', '120110',
            '420102', '420103', '420104', '420105', '420106', '420107', '420111',
            '610102', '610103', '610104', '610111', '610112', '610113', '610114',
            '320102', '320104', '320105', '320106', '320111', '320113', '320114',
            '330102', '330103', '330104', '330105', '330106', '330108', '330109',
            '510104', '510105', '510106', '510107', '510108', '510112', '510113'
        ];

        // å›½å®¶å’Œåœ°åŒºä»£ç æ˜ å°„ (æ ¹æ®GB/T 2659.1æ ‡å‡†)
        const countryCodes = {
            'USA': '840', // ç¾å›½
            'CAN': '124', // åŠ æ‹¿å¤§
            'GBR': '826', // è‹±å›½
            'AUS': '036', // æ¾³å¤§åˆ©äºš
            'JPN': '392', // æ—¥æœ¬
            'KOR': '410', // éŸ©å›½
            'GER': '276', // å¾·å›½
            'FRA': '250', // æ³•å›½
            'ITA': '380', // æ„å¤§åˆ©
            'ESP': '724', // è¥¿ç­ç‰™
            'BRA': '076', // å·´è¥¿
            'RUS': '643', // ä¿„ç½—æ–¯
            'IND': '356', // å°åº¦
            'SAU': '682', // æ²™ç‰¹é˜¿æ‹‰ä¼¯
            'MEX': '484', // å¢¨è¥¿å“¥
            'NLD': '528', // è·å…°
            'CHE': '756', // ç‘å£«
            'SWE': '752', // ç‘å…¸
            'NOR': '578', // æŒªå¨
            'DNK': '208', // ä¸¹éº¦
            'FIN': '246', // èŠ¬å…°
            'BEL': '056', // æ¯”åˆ©æ—¶
            'AUT': '040', // å¥¥åœ°åˆ©
            'PRT': '620', // è‘¡è„ç‰™
            'GRC': '300', // å¸Œè…Š
            'IRL': '372', // çˆ±å°”å…°
            'POL': '616', // æ³¢å…°
            'CZE': '203', // æ·å…‹
            'HUN': '348', // åŒˆç‰™åˆ©
            'ROU': '642', // ç½—é©¬å°¼äºš
            'BGR': '100', // ä¿åŠ åˆ©äºš
            'HRV': '191', // å…‹ç½—åœ°äºš
            'SRB': '688', // å¡å°”ç»´äºš
            'UKR': '804', // ä¹Œå…‹å…°
            'BLR': '112', // ç™½ä¿„ç½—æ–¯
            'KAZ': '398', // å“ˆè¨å…‹æ–¯å¦
            'UZB': '860', // ä¹Œå…¹åˆ«å…‹æ–¯å¦
            'TUR': '792', // åœŸè€³å…¶
            'ISR': '376', // ä»¥è‰²åˆ—
            'ARE': '784', // é˜¿è”é…‹
            'QAT': '634', // å¡å¡”å°”
            'KWT': '414', // ç§‘å¨ç‰¹
            'OMN': '512', // é˜¿æ›¼
            'BHR': '048', // å·´æ—
            'SGP': '702', // æ–°åŠ å¡
            'MYS': '458', // é©¬æ¥è¥¿äºš
            'IDN': '360', // å°åº¦å°¼è¥¿äºš
            'THA': '764', // æ³°å›½
            'VNM': '704', // è¶Šå—
            'PHL': '608', // è²å¾‹å®¾
            'MMR': '104', // ç¼…ç”¸
            'KHM': '116', // æŸ¬åŸ”å¯¨
            'LAO': '418', // è€æŒ
            'NPL': '524', // å°¼æ³Šå°”
            'PAK': '586', // å·´åŸºæ–¯å¦
            'BGD': '050', // å­ŸåŠ æ‹‰å›½
            'LKA': '144', // æ–¯é‡Œå…°å¡
            'MDV': '462', // é©¬å°”ä»£å¤«
            'AFG': '004', // é˜¿å¯Œæ±—
            'IRN': '364', // ä¼Šæœ—
            'IRQ': '368', // ä¼Šæ‹‰å…‹
            'SYR': '760', // å™åˆ©äºš
            'JOR': '400', // çº¦æ—¦
            'LBN': '422', // é»å·´å«©
            'PSE': '275', // å·´å‹’æ–¯å¦
            'EGY': '818', // åŸƒåŠ
            'DZA': '012', // é˜¿å°”åŠåˆ©äºš
            'MAR': '504', // æ‘©æ´›å“¥
            'TUN': '788', // çªå°¼æ–¯
            'LBY': '434', // åˆ©æ¯”äºš
            'SDN': '729', // è‹ä¸¹
            'NGA': '566', // å°¼æ—¥åˆ©äºš
            'GHA': '288', // åŠ çº³
            'CIV': '384', // ç§‘ç‰¹è¿ªç“¦
            'SEN': '686', // å¡å†…åŠ å°”
            'ZAF': '710', // å—é
            'KEN': '404', // è‚¯å°¼äºš
            'ETH': '231', // åŸƒå¡ä¿„æ¯”äºš
            'TZA': '834', // å¦æ¡‘å°¼äºš
            'UGA': '800', // ä¹Œå¹²è¾¾
            'AGO': '024', // å®‰å“¥æ‹‰
            'MOZ': '508', // è«æ¡‘æ¯”å…‹
            'ZMB': '894', // èµæ¯”äºš
            'ZWE': '716', // æ´¥å·´å¸ƒéŸ¦
            'ARG': '032', // é˜¿æ ¹å»·
            'CHL': '152', // æ™ºåˆ©
            'PER': '604', // ç§˜é²
            'COL': '170', // å“¥ä¼¦æ¯”äºš
            'VEN': '862', // å§”å†…ç‘æ‹‰
            'ECU': '218', // å„ç“œå¤šå°”
            'BOL': '068', // ç»åˆ©ç»´äºš
            'PRY': '600', // å·´æ‹‰åœ­
            'URY': '858'  // ä¹Œæ‹‰åœ­
        };

        // é“¶è¡ŒBINå·
        const bankBins = {
            'icbc': ['622200', '622202', '622208', '622210', '622211', '622212'],
            'ccb': ['622700', '622280', '622966', '622988'],
            'abc': ['622820', '622821', '622822', '622823', '622824', '622825'],
            'boc': ['456351', '601382', '622752', '622753', '622755'],
            'bcm': ['622260', '622261', '622262', '622263'],
            'cmb': ['622575', '622576', '622577', '622578', '622579'],
            'psbc': ['622150', '622151', '622181', '622188'],
            'cmbc': ['622600', '622601', '622602', '622603'],
            'citic': ['622690', '622691', '622692', '622696'],
            'ceb': ['622660', '622661', '622662', '622663', '622664'],
            'spdb': ['622516', '622517', '622518', '622521', '622522'],
            'cib': ['622909', '622908', '622906', '622902'],
            'pingan': ['622155', '622156', '622157', '622158'],
            'hxb': ['622630', '622631', '622632', '622633'],
            'cgb': ['622568', '622569', '622570', '622571']
        };

        // é“¶è¡Œåç§°æ˜ å°„
        const bankNames = {
            'icbc': 'å·¥å•†é“¶è¡Œ',
            'ccb': 'å»ºè®¾é“¶è¡Œ',
            'abc': 'å†œä¸šé“¶è¡Œ',
            'boc': 'ä¸­å›½é“¶è¡Œ',
            'bcm': 'äº¤é€šé“¶è¡Œ',
            'cmb': 'æ‹›å•†é“¶è¡Œ',
            'psbc': 'é‚®å‚¨é“¶è¡Œ',
            'cmbc': 'æ°‘ç”Ÿé“¶è¡Œ',
            'citic': 'ä¸­ä¿¡é“¶è¡Œ',
            'ceb': 'å…‰å¤§é“¶è¡Œ',
            'spdb': 'æµ¦å‘é“¶è¡Œ',
            'cib': 'å…´ä¸šé“¶è¡Œ',
            'pingan': 'å¹³å®‰é“¶è¡Œ',
            'hxb': 'åå¤é“¶è¡Œ',
            'cgb': 'å¹¿å‘é“¶è¡Œ'
        };

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            currentTab = tabName;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ˜¾ç¤º/éšè—å¯¹åº”å†…å®¹
            document.getElementById('ageRangeTab').style.display = tabName === 'ageRange' ? 'block' : 'none';
            document.getElementById('specificDateTab').style.display = tabName === 'specificDate' ? 'block' : 'none';
        }

		// è®¡ç®—å¹´é¾„ï¼ˆå‘¨å²å’Œå¤©æ•°ï¼‰
        function calculateAge(birthDateStr) {
            const birthDate = new Date(
                parseInt(birthDateStr.substring(0, 4)),
                parseInt(birthDateStr.substring(4, 6)) - 1,
                parseInt(birthDateStr.substring(6, 8))
            );
            const today = new Date();
            
            // è®¡ç®—å‘¨å²
            let years = today.getFullYear() - birthDate.getFullYear();
            
            // å¦‚æœä»Šå¹´çš„ç”Ÿæ—¥è¿˜æ²¡è¿‡ï¼Œå‘¨å²å‡1
            const thisYearBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
            if (today < thisYearBirthday) {
                years--;
            }
            
            // è®¡ç®—å¤©æ•°
            let days;
            if (today >= thisYearBirthday) {
                // ç”Ÿæ—¥å·²ç»è¿‡äº†ï¼Œè®¡ç®—ä»ç”Ÿæ—¥åˆ°ä»Šå¤©çš„å¤©æ•°
                const lastBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                days = Math.floor((today - lastBirthday) / (1000 * 60 * 60 * 24));
            } else {
                // ç”Ÿæ—¥è¿˜æ²¡è¿‡ï¼Œè®¡ç®—ä»å»å¹´ç”Ÿæ—¥åˆ°ä»Šå¤©çš„å¤©æ•°
                const lastBirthday = new Date(today.getFullYear() - 1, birthDate.getMonth(), birthDate.getDate());
                days = Math.floor((today - lastBirthday) / (1000 * 60 * 60 * 24));
            }
            
            return { years, days };
        }
		
        // æ ¹æ®å¹´é¾„èŒƒå›´ç”Ÿæˆéšæœºæ—¥æœŸï¼ˆä¿®æ­£ç‰ˆï¼‰
        function randomDateFromAgeRange(minAge, minUnit, maxAge, maxUnit) {
            const today = new Date();
            
            // å°†å¹´é¾„ç»Ÿä¸€è½¬æ¢ä¸ºå¤©æ•°
            function convertToDays(value, unit) {
                if (unit === 'days') {
                    return value;
                } else {
                    // å‘¨å²è½¬æ¢ä¸ºå¤©æ•°ï¼ˆè¿‘ä¼¼å€¼ï¼š1å¹´=365.25å¤©ï¼‰
                    return Math.floor(value * 365.25);
                }
            }
            
            const minDays = convertToDays(minAge, minUnit);
            const maxDays = convertToDays(maxAge, maxUnit);
            
            // ç¡®ä¿minDays <= maxDays
            if (minDays > maxDays) {
                [minDays, maxDays] = [maxDays, minDays];
            }
            
            // è®¡ç®—æ—¥æœŸèŒƒå›´
            const maxDate = new Date(today);
            maxDate.setDate(today.getDate() - minDays); // æœ€å°å¹´é¾„å¯¹åº”æœ€æ™šæ—¥æœŸ
            
            const minDate = new Date(today);
            minDate.setDate(today.getDate() - maxDays); // æœ€å¤§å¹´é¾„å¯¹åº”æœ€æ—©æ—¥æœŸ
            
            // ç¡®ä¿æœ€å°æ—¥æœŸä¸æ™šäºæœ€å¤§æ—¥æœŸ
            if (minDate > maxDate) {
                [minDate, maxDate] = [maxDate, minDate];
            }
            
            // ç”Ÿæˆéšæœºæ—¥æœŸ
            const randomTime = minDate.getTime() + Math.random() * (maxDate.getTime() - minDate.getTime());
            const randomDate = new Date(randomTime);
            
            const year = randomDate.getFullYear();
            const month = String(randomDate.getMonth() + 1).padStart(2, '0');
            const day = String(randomDate.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        // ä»å…·ä½“æ—¥æœŸç”Ÿæˆ
        function dateFromSpecificDate(specificDate) {
            const date = new Date(specificDate);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        // è®¡ç®—èº«ä»½è¯æ ¡éªŒç 
        function calculateCheckCode(idNumber) {
            const weights = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2];
            const checkCodes = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];
            let sum = 0;
            for (let i = 0; i < 17; i++) {
                sum += parseInt(idNumber[i]) * weights[i];
            }
            return checkCodes[sum % 11];
        }

        // ç”Ÿæˆä¸­å›½å¤§é™†èº«ä»½è¯
        function generateIDCard(gender, birthDate) {
            const areaCode = areaCodes[Math.floor(Math.random() * areaCodes.length)];
            const sequence = String(Math.floor(Math.random() * 999)).padStart(3, '0');
            
            let genderCode;
            if (gender === 'male') {
                genderCode = Math.floor(Math.random() * 5) * 2 + 1;
            } else if (gender === 'female') {
                genderCode = Math.floor(Math.random() * 5) * 2;
            } else {
                genderCode = Math.floor(Math.random() * 10);
            }
            
            const idWithoutCheck = areaCode + birthDate + sequence.slice(0, 2) + genderCode;
            const checkCode = calculateCheckCode(idWithoutCheck);
            return idWithoutCheck + checkCode;
        }

        // ç”Ÿæˆæ¸¯æ¾³å°å±…æ°‘å±…ä½è¯
        function generateResidencePermit(region, birthDate) {
            let prefix;
            if (region === 'hk') prefix = '810000';
            else if (region === 'macao') prefix = '820000';
            else prefix = '830000';
            
            const sequence = String(Math.floor(Math.random() * 999)).padStart(3, '0');
            
            let genderCode;
            if (Math.random() > 0.5) {
                genderCode = Math.floor(Math.random() * 5) * 2 + 1; // å¥‡æ•°ä»£è¡¨ç”·æ€§
            } else {
                genderCode = Math.floor(Math.random() * 5) * 2; // å¶æ•°ä»£è¡¨å¥³æ€§
            }
            
            const idWithoutCheck = prefix + birthDate + sequence.slice(0, 2) + genderCode;
            const checkCode = calculateCheckCode(idWithoutCheck);
            return idWithoutCheck + checkCode;
        }

        // ç”Ÿæˆæ–°ç‰ˆå¤–å›½äººæ°¸ä¹…å±…ç•™è¯ (18ä½)
        function generateNewForeignerPermit(gender, birthDate) {
            // 1ä½èº«ä»½æ ‡è¯†ç  - å›ºå®šä¸º"9"
            const identityCode = "9";
            
            // 2ä½é¦–æ¬¡ç”³é¢†åœ°ä»£ç  - è¡Œæ”¿åŒºåˆ’ä»£ç å‰ä¸¤ä½
            const areaCode = areaCodes[Math.floor(Math.random() * areaCodes.length)].slice(0, 2);
            
            // 3ä½å›½å®¶å’Œåœ°åŒºä»£ç  - ä»countryCodesä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ•°å­—ä»£ç 
            const countryKeys = Object.keys(countryCodes);
            const randomCountry = countryKeys[Math.floor(Math.random() * countryKeys.length)];
            const countryCode = countryCodes[randomCountry];
            
            // 3ä½é¡ºåºç  - å¥‡æ•°åˆ†é…ç»™ç”·æ€§ï¼Œå¶æ•°åˆ†é…ç»™å¥³æ€§
            let sequenceCode;
            if (gender === 'male') {
                // ç”Ÿæˆå¥‡æ•° (001, 003, 005, ..., 999)
                sequenceCode = String(Math.floor(Math.random() * 500) * 2 + 1).padStart(3, '0');
            } else if (gender === 'female') {
                // ç”Ÿæˆå¶æ•° (002, 004, 006, ..., 998)
                sequenceCode = String(Math.floor(Math.random() * 500) * 2).padStart(3, '0');
            } else {
                // éšæœºç”Ÿæˆ
                sequenceCode = String(Math.floor(Math.random() * 999) + 1).padStart(3, '0');
            }
            
            // ç»„åˆå‰17ä½
            const idWithoutCheck = identityCode + areaCode + countryCode + birthDate + sequenceCode;
            
            // è®¡ç®—æ ¡éªŒç 
            const checkCode = calculateCheckCode(idWithoutCheck);
            
            return idWithoutCheck + checkCode;
        }

        // ç”Ÿæˆæ—§ç‰ˆå¤–å›½äººæ°¸ä¹…å±…ç•™è¯ (15ä½)
        function generateOldForeignerPermit() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const letter1 = letters[Math.floor(Math.random() * letters.length)];
            const letter2 = letters[Math.floor(Math.random() * letters.length)];
            const letter3 = letters[Math.floor(Math.random() * letters.length)];
            const numbers = String(Math.floor(Math.random() * 1000000000)).padStart(9, '0');
            return letter1 + letter2 + letter3 + numbers;
        }

        // ç”Ÿæˆæ¸¯æ¾³é€šè¡Œè¯
        function generateHKMacaoPass(region) {
            let prefix;
            if (region === 'hk') prefix = 'H';
            else prefix = 'M';
            
            const numbers = String(Math.floor(Math.random() * 100000000)).padStart(8, '0');
            return prefix + numbers;
        }

        // ç”Ÿæˆå°æ¹¾é€šè¡Œè¯
        function generateTaiwanPass() {
            return String(Math.floor(Math.random() * 100000000)).padStart(8, '0');
        }

        // ç”ŸæˆæŠ¤ç…§
        function generatePassport() {
            const passportTypes = [
                () => {
                    // G/E+8ä½æ•°å­—
                    const prefix = Math.random() > 0.5 ? 'G' : 'E';
                    const numbers = String(Math.floor(Math.random() * 100000000)).padStart(8, '0');
                    return prefix + numbers;
                },
                () => {
                    // SE+7ä½æ•°å­—
                    const numbers = String(Math.floor(Math.random() * 10000000)).padStart(7, '0');
                    return 'SE' + numbers;
                },
                () => {
                    // DE+7ä½æ•°å­—
                    const numbers = String(Math.floor(Math.random() * 10000000)).padStart(7, '0');
                    return 'DE' + numbers;
                },
                () => {
                    // PE+7ä½æ•°å­—
                    const numbers = String(Math.floor(Math.random() * 10000000)).padStart(7, '0');
                    return 'PE' + numbers;
                },
                () => {
                    // E+1ä½å­—æ¯+7ä½æ•°å­—
                    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                    const letter = letters[Math.floor(Math.random() * letters.length)];
                    const numbers = String(Math.floor(Math.random() * 10000000)).padStart(7, '0');
                    return 'E' + letter + numbers;
                }
            ];
            
            return passportTypes[Math.floor(Math.random() * passportTypes.length)]();
        }

        // ç”Ÿæˆæ‰‹æœºå·
        function generatePhoneNumber() {
            const prefixes = ['130', '131', '132', '133', '134', '135', '136', '137', '138', '139',
                            '150', '151', '152', '153', '155', '156', '157', '158', '159',
                            '180', '181', '182', '183', '184', '185', '186', '187', '188', '189'];
            const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
            const suffix = String(Math.floor(Math.random() * 100000000)).padStart(8, '0');
            return prefix + suffix;
        }

        // ç”Ÿæˆé“¶è¡Œå¡å·
        function generateBankCard(bankType, suffix = '') {
            let actualBankType = bankType;
            
            // å¦‚æœæ˜¯éšæœºé“¶è¡Œï¼Œä»é“¶è¡Œåˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª
            if (bankType === 'random') {
                const bankKeys = Object.keys(bankBins);
                actualBankType = bankKeys[Math.floor(Math.random() * bankKeys.length)];
            }
            
            const bins = bankBins[actualBankType];
            const bin = bins[Math.floor(Math.random() * bins.length)];
            
            // ç”Ÿæˆä¸­é—´å·ç ï¼Œç¡®ä¿æ€»é•¿åº¦ä¸º16-19ä½
            let middleLength;
            if (suffix) {
                middleLength = 16 - bin.length - suffix.length;
            } else {
                middleLength = 10 + Math.floor(Math.random() * 4); // 10-13ä½ä¸­é—´å·ç 
            }
            
            let middle = '';
            for (let i = 0; i < middleLength; i++) {
                middle += Math.floor(Math.random() * 10);
            }
            
            let cardNumber = bin + middle;
            
            // å¦‚æœæŒ‡å®šäº†å°¾å·ï¼Œæ›¿æ¢æœ€åå‡ ä½
            if (suffix) {
                cardNumber = cardNumber.slice(0, -suffix.length) + suffix;
            }
            
            return {
                number: cardNumber,
                bank: bankNames[actualBankType]
            };
        }

        // ç”Ÿæˆå§“å
        function generateName(type, gender) {
            if (type === 'chinese') {
                const surname = surnames[Math.floor(Math.random() * surnames.length)];
                const givenName = givenNames[Math.floor(Math.random() * givenNames.length)];
                return surname + givenName;
            } else {
                const firstName = englishFirstNames[Math.floor(Math.random() * englishFirstNames.length)];
                const lastName = englishLastNames[Math.floor(Math.random() * englishLastNames.length)];
                return firstName + ' ' + lastName;
            }
        }

// å•ä¸ªç”Ÿæˆ
        function generate() {
            const docType = document.getElementById('docType').value;
            const gender = document.getElementById('gender').value;
            const nameType = document.getElementById('nameType').value;
            const region = document.getElementById('region').value;
            const hkmacaoRegion = document.getElementById('hkmacaoRegion').value;
            const foreignerVersion = document.getElementById('foreignerVersion').value;
            const generateBankCardChecked = document.getElementById('generateBankCard').checked;
            const bankType = document.getElementById('bankType').value;
            const cardSuffix = document.getElementById('cardSuffix').value;

            let birthDate;
            
            // æ ¹æ®å½“å‰æ ‡ç­¾é¡µç¡®å®šå‡ºç”Ÿæ—¥æœŸç”Ÿæˆæ–¹å¼
            if (currentTab === 'ageRange') {
                const minAge = parseInt(document.getElementById('minAge').value);
                const minUnit = document.getElementById('minAgeUnit').value;
                const maxAge = parseInt(document.getElementById('maxAge').value);
                const maxUnit = document.getElementById('maxAgeUnit').value;

                if (minAge > maxAge && minUnit === maxUnit) {
                    alert('æœ€å°å¹´é¾„ä¸èƒ½å¤§äºæœ€å¤§å¹´é¾„ï¼');
                    return;
                }

                birthDate = randomDateFromAgeRange(minAge, minUnit, maxAge, maxUnit);
            } else {
                const specificDate = document.getElementById('specificDate').value;
                if (!specificDate) {
                    alert('è¯·é€‰æ‹©å…·ä½“å‡ºç”Ÿæ—¥æœŸï¼');
                    return;
                }
                birthDate = dateFromSpecificDate(specificDate);
            }

            const actualGender = gender === 'random' ? (Math.random() > 0.5 ? 'male' : 'female') : gender;
            const name = generateName(nameType, actualGender);
            let docNumber;
            let phoneNumber = generatePhoneNumber();
            let bankCardInfo = null;

            switch(docType) {
                case 'idcard':
                    docNumber = generateIDCard(actualGender, birthDate);
                    break;
                case 'residence':
                    docNumber = generateResidencePermit(region, birthDate);
                    break;
                case 'foreigner':
                    if (foreignerVersion === 'new') {
                        docNumber = generateNewForeignerPermit(actualGender, birthDate);
                    } else {
                        docNumber = generateOldForeignerPermit();
                    }
                    break;
                case 'hkmacao':
                    docNumber = generateHKMacaoPass(hkmacaoRegion);
                    break;
                case 'taiwan':
                    docNumber = generateTaiwanPass();
                    break;
                case 'passport':
                    docNumber = generatePassport();
                    break;
            }

            // ç”Ÿæˆé“¶è¡Œå¡
            if (generateBankCardChecked) {
                bankCardInfo = generateBankCard(bankType, cardSuffix);
            }

            const genderText = actualGender === 'male' ? 'ç”·' : 'å¥³';
            const docTypeText = {
                'idcard': 'ä¸­å›½å¤§é™†èº«ä»½è¯',
                'residence': 'æ¸¯æ¾³å°å±…æ°‘å±…ä½è¯',
                'foreigner': 'å¤–å›½äººæ°¸ä¹…å±…ç•™è¯',
                'hkmacao': 'æ¸¯æ¾³é€šè¡Œè¯',
                'taiwan': 'å°æ¹¾é€šè¡Œè¯',
                'passport': 'æŠ¤ç…§'
            }[docType];

            // æ ¼å¼åŒ–å‡ºç”Ÿæ—¥æœŸæ˜¾ç¤º
            const formattedBirthDate = `${birthDate.substring(0,4)}-${birthDate.substring(4,6)}-${birthDate.substring(6,8)}`;
            
            // è®¡ç®—å¹´é¾„
            const age = calculateAge(birthDate);
            const ageText = `ï¼ˆ${age.years}å‘¨å²${age.days}å¤©ï¼‰`;

            let resultHTML = `
                <div class="result-item"><strong>å§“åï¼š</strong>${name}</div>
                <div class="result-item"><strong>æ€§åˆ«ï¼š</strong>${genderText}</div>
                <div class="result-item"><strong>è¯ä»¶ç±»å‹ï¼š</strong>${docTypeText}</div>
                <div class="result-item"><strong>å‡ºç”Ÿæ—¥æœŸï¼š</strong>${formattedBirthDate}${ageText}</div>
                <div class="result-item"><strong>è¯ä»¶å·ç ï¼š</strong>${docNumber}</div>
                <div class="result-item"><strong>æ‰‹æœºå·ï¼š</strong>${phoneNumber}</div>
            `;

            if (docType === 'foreigner') {
                resultHTML += `<div class="result-item"><strong>è¯ä»¶ç‰ˆæœ¬ï¼š</strong>${foreignerVersion === 'new' ? 'æ–°ç‰ˆ (18ä½)' : 'æ—§ç‰ˆ (15ä½)'}</div>`;
            }

            if (bankCardInfo) {
                resultHTML += `<div class="result-item"><strong>é“¶è¡Œå¡ï¼š</strong>${bankCardInfo.bank} - ${bankCardInfo.number}</div>`;
            }

            document.getElementById('result').innerHTML = resultHTML;
        }

        // æ‰¹é‡ç”Ÿæˆ
        function batchGenerate() {
            const docType = document.getElementById('batchDocType').value;
            const count = parseInt(document.getElementById('batchCount').value);
            const region = document.getElementById('batchRegion').value;
            const hkmacaoRegion = document.getElementById('batchHkmacaoRegion').value;
            const foreignerVersion = document.getElementById('batchForeignerVersion').value;
            const generateBankCardChecked = document.getElementById('batchGenerateBankCard').checked;
            const bankType = document.getElementById('batchBankType').value;

            if (count < 1 || count > 1000) {
                alert('ç”Ÿæˆæ•°é‡å¿…é¡»åœ¨1-1000ä¹‹é—´ï¼');
                return;
            }

            batchData = [];
            let html = '<table><thead><tr><th>åºå·</th><th>å§“å</th><th>æ€§åˆ«</th><th>å‡ºç”Ÿæ—¥æœŸ</th><th>å¹´é¾„</th><th>è¯ä»¶å·ç </th><th>æ‰‹æœºå·</th>';

            if (generateBankCardChecked) {
                html += '<th>é“¶è¡Œå¡å·</th><th>é“¶è¡Œ</th>';
            }

            html += '</tr></thead><tbody>';

            for (let i = 0; i < count; i++) {
                const gender = Math.random() > 0.5 ? 'male' : 'female';
                const nameType = Math.random() > 0.5 ? 'chinese' : 'english';
                const name = generateName(nameType, gender);
                const minAge = 18;
                const maxAge = 65;
                
                // æ‰¹é‡ç”Ÿæˆä½¿ç”¨é»˜è®¤çš„å¹´é¾„èŒƒå›´ç”Ÿæˆæ–¹å¼
                const birthDate = randomDateFromAgeRange(minAge, 'years', maxAge, 'years');
                const formattedBirthDate = `${birthDate.substring(0,4)}-${birthDate.substring(4,6)}-${birthDate.substring(6,8)}`;
                
                // è®¡ç®—å¹´é¾„
                const age = calculateAge(birthDate);
                const ageText = `${age.years}å‘¨å²${age.days}å¤©`;
                
                let docNumber;
                const phoneNumber = generatePhoneNumber();
                let bankCardInfo = null;

                switch(docType) {
                    case 'idcard':
                        docNumber = generateIDCard(gender, birthDate);
                        break;
                    case 'residence':
                        docNumber = generateResidencePermit(region, birthDate);
                        break;
                    case 'foreigner':
                        if (foreignerVersion === 'new') {
                            docNumber = generateNewForeignerPermit(gender, birthDate);
                        } else {
                            docNumber = generateOldForeignerPermit();
                        }
                        break;
                    case 'hkmacao':
                        docNumber = generateHKMacaoPass(hkmacaoRegion);
                        break;
                    case 'taiwan':
                        docNumber = generateTaiwanPass();
                        break;
                    case 'passport':
                        docNumber = generatePassport();
                        break;
                }

                // ç”Ÿæˆé“¶è¡Œå¡
                if (generateBankCardChecked) {
                    bankCardInfo = generateBankCard(bankType);
                }

                const genderText = gender === 'male' ? 'ç”·' : 'å¥³';
                
                let dataItem = { 
                    name, 
                    gender: genderText,
                    birthDate: formattedBirthDate,
                    age: ageText,
                    docNumber,
                    phoneNumber
                };

                if (generateBankCardChecked) {
                    dataItem.bankCardNumber = bankCardInfo.number;
                    dataItem.bankName = bankCardInfo.bank;
                }

                batchData.push(dataItem);
                
                html += `<tr><td>${i + 1}</td><td>${name}</td><td>${genderText}</td><td>${formattedBirthDate}</td><td>${ageText}</td><td>${docNumber}</td><td>${phoneNumber}</td>`;
                
                if (generateBankCardChecked) {
                    html += `<td>${bankCardInfo.number}</td><td>${bankCardInfo.bank}</td>`;
                }
                
                html += `</tr>`;
            }

            html += '</tbody></table>';
            document.getElementById('batchResult').innerHTML = html;
            document.getElementById('exportButtons').style.display = 'flex';
        }

        // å¯¼å‡ºæ•°æ®
        function exportData(format) {
            if (batchData.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆæ•°æ®ï¼');
                return;
            }

            let content, filename, type;

            if (format === 'json') {
                content = JSON.stringify(batchData, null, 2);
                filename = 'identity_data.json';
                type = 'application/json';
            } else if (format === 'csv') {
                const hasBankCard = batchData[0].hasOwnProperty('bankCardNumber');
                content = '\ufeffå§“å,æ€§åˆ«,å‡ºç”Ÿæ—¥æœŸ,å¹´é¾„,è¯ä»¶å·ç ,æ‰‹æœºå·';
                if (hasBankCard) {
                    content += ',é“¶è¡Œå¡å·,é“¶è¡Œ\n';
                } else {
                    content += '\n';
                }
                
                batchData.forEach(item => {
                    content += `${item.name},${item.gender},${item.birthDate},${item.age},${item.docNumber},${item.phoneNumber}`;
                    if (hasBankCard) {
                        content += `,${item.bankCardNumber},${item.bankName}`;
                    }
                    content += '\n';
                });
                filename = 'identity_data.csv';
                type = 'text/csv';
            } else if (format === 'txt') {
                content = '\ufeff';
                batchData.forEach((item, index) => {
                    content += `${index + 1}. å§“åï¼š${item.name} | æ€§åˆ«ï¼š${item.gender} | å‡ºç”Ÿæ—¥æœŸï¼š${item.birthDate} | å¹´é¾„ï¼š${item.age} | è¯ä»¶å·ç ï¼š${item.docNumber} | æ‰‹æœºå·ï¼š${item.phoneNumber}`;
                    if (item.bankCardNumber) {
                        content += ` | é“¶è¡Œå¡ï¼š${item.bankName} - ${item.bankCardNumber}`;
                    }
                    content += '\n';
                });
                filename = 'identity_data.txt';
                type = 'text/plain';
            }

            const blob = new Blob([content], { type: type + ';charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
        }

        // ç›‘å¬è¯ä»¶ç±»å‹å˜åŒ–
        document.getElementById('docType').addEventListener('change', function() {
            const regionGroup = document.getElementById('regionGroup');
            const foreignerVersionGroup = document.getElementById('foreignerVersionGroup');
            const hkmacaoRegionGroup = document.getElementById('hkmacaoRegionGroup');
            
            // éšè—æ‰€æœ‰é€‰é¡¹ç»„
            regionGroup.style.display = 'none';
            foreignerVersionGroup.style.display = 'none';
            hkmacaoRegionGroup.style.display = 'none';
            
            // æ ¹æ®é€‰æ‹©çš„è¯ä»¶ç±»å‹æ˜¾ç¤ºç›¸åº”çš„é€‰é¡¹ç»„
            if (this.value === 'residence') {
                regionGroup.style.display = 'block';
            } else if (this.value === 'foreigner') {
                foreignerVersionGroup.style.display = 'block';
            } else if (this.value === 'hkmacao') {
                hkmacaoRegionGroup.style.display = 'block';
            }
        });

        // ç›‘å¬æ‰¹é‡ç”Ÿæˆè¯ä»¶ç±»å‹å˜åŒ–
        document.getElementById('batchDocType').addEventListener('change', function() {
            const batchRegionGroup = document.getElementById('batchRegionGroup');
            const batchForeignerVersionGroup = document.getElementById('batchForeignerVersionGroup');
            const batchHkmacaoRegionGroup = document.getElementById('batchHkmacaoRegionGroup');
            
            // éšè—æ‰€æœ‰é€‰é¡¹ç»„
            batchRegionGroup.style.display = 'none';
            batchForeignerVersionGroup.style.display = 'none';
            batchHkmacaoRegionGroup.style.display = 'none';
            
            // æ ¹æ®é€‰æ‹©çš„è¯ä»¶ç±»å‹æ˜¾ç¤ºç›¸åº”çš„é€‰é¡¹ç»„
            if (this.value === 'residence') {
                batchRegionGroup.style.display = 'block';
            } else if (this.value === 'foreigner') {
                batchForeignerVersionGroup.style.display = 'block';
            } else if (this.value === 'hkmacao') {
                batchHkmacaoRegionGroup.style.display = 'block';
            }
        });

        // åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†ä¸ºä»Šå¤©
        document.getElementById('specificDate').valueAsDate = new Date();
    </script>
</body>
</html>