<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æœ¬æ¯”å¯¹å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .header p {
            font-size: 1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 10px;
        }

        .text-box {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .text-box-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .text-box label {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .text-box label span {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 26px;
            height: 26px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            font-size: 0.85em;
        }

        .text-box textarea {
            flex: 1;
            min-height: 300px;
            max-height: 500px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.6;
            resize: vertical;
            font-family: 'Consolas', 'Monaco', monospace;
            transition: border-color 0.3s;
            overflow-y: auto;
        }

        .text-box textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .control-section {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 10px 0;
        }

        .control-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .control-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .control-btn.secondary {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #ddd;
        }

        .control-btn.secondary:hover {
            background: #e9ecef;
        }

        .control-btn.warning {
            background: #FF9800;
            color: white;
        }

        .control-btn.warning:hover {
            background: #F57C00;
        }

        .result-section {
            display: none;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 1px solid #e0e0e0;
        }

        .result-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .summary-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.05);
        }

        .similarity-display {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .similarity-circle {
            position: relative;
            width: 80px;
            height: 80px;
            flex-shrink: 0;
        }

        .circle-bg {
            fill: none;
            stroke: #e0e0e0;
            stroke-width: 8;
        }

        .circle-progress {
            fill: none;
            stroke: #4CAF50;
            stroke-width: 8;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
            transition: stroke-dasharray 1s ease;
        }

        .similarity-percent {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            text-align: center;
            line-height: 1.2;
        }

        .similarity-percent span {
            display: block;
            font-size: 0.4em;
            color: #666;
            font-weight: normal;
            margin-top: 2px;
        }

        .similarity-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .similarity-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .similarity-label {
            font-size: 1.1em;
            color: #666;
            font-weight: 500;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            flex: 1;
            max-width: 600px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            color: #666;
        }

        .highlight-section {
            margin-top: 20px;
        }

        .highlight-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .highlight-header h3 {
            font-size: 1.2em;
            color: #333;
            font-weight: 600;
        }

        .legend {
            display: flex;
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            color: #666;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        .legend-color.same {
            background: #4CAF50;
        }

        .legend-color.diff {
            background: #F44336;
        }

        .text-display-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            height: 500px;
        }

        .text-display {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-y: auto;
            height: 100%;
        }

        .text-display::-webkit-scrollbar {
            width: 8px;
        }

        .text-display::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .text-display::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .text-display::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .text-display-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .text-display-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
        }

        .text-display-count {
            font-size: 0.9em;
            color: #666;
            background: #f8f9fa;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .footer-info {
            margin-top: 30px;
            padding: 15px;
            background: #e8f4fc;
            border-radius: 8px;
            color: #2c3e50;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .footer-info strong {
            color: #667eea;
        }

        .empty-state {
            color: #999;
            text-align: center;
            padding: 60px 20px;
            font-style: italic;
        }

        /* æ–‡æœ¬å·®å¼‚é«˜äº®æ ·å¼ */
        .diff-same {
            background-color: rgba(76, 175, 80, 0.15);
            color: #2e7d32;
            padding: 1px 0;
            border-radius: 2px;
        }

        .diff-different {
            background-color: rgba(244, 67, 54, 0.15);
            color: #c62828;
            padding: 1px 0;
            border-radius: 2px;
            font-weight: bold;
        }

        @media (max-width: 1024px) {
            .container {
                max-width: 95%;
            }
            
            .input-section,
            .text-display-area {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .summary-bar {
                flex-direction: column;
                gap: 20px;
                align-items: stretch;
            }
            
            .similarity-display {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .control-section {
                flex-wrap: wrap;
            }
            
            .control-btn {
                flex: 1;
                min-width: 140px;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .text-display-area {
                height: 400px;
            }
            
            .text-display {
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .legend {
                flex-direction: column;
                gap: 10px;
            }
            
            .text-display-area {
                height: 350px;
            }
            
            .similarity-circle {
                width: 70px;
                height: 70px;
            }
            
            .similarity-value {
                font-size: 1.6em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” æ–‡æœ¬æ¯”å¯¹å·¥å…·</h1>
            <p>å¿«é€Ÿæ¯”è¾ƒä¸¤æ®µæ–‡æœ¬çš„å·®å¼‚ï¼Œè®¡ç®—ç›¸ä¼¼åº¦ï¼Œå¹¶é«˜äº®æ˜¾ç¤ºä¸åŒä¹‹å¤„</p>
        </div>

        <div class="main-content">
            <!-- æ–‡æœ¬è¾“å…¥åŒºåŸŸ -->
            <div class="input-section">
                <div class="text-box">
                    <div class="text-box-header">
                        <label><span>1</span>ç¬¬ä¸€æ®µæ–‡æœ¬</label>
                        <div class="text-count" id="text1-count">0 å­—ç¬¦</div>
                    </div>
                    <textarea id="text1" rows="12" placeholder="è¯·è¾“å…¥æˆ–ç²˜è´´ç¬¬ä¸€æ®µæ–‡æœ¬..."></textarea>
                </div>
                <div class="text-box">
                    <div class="text-box-header">
                        <label><span>2</span>ç¬¬äºŒæ®µæ–‡æœ¬</label>
                        <div class="text-count" id="text2-count">0 å­—ç¬¦</div>
                    </div>
                    <textarea id="text2" rows="12" placeholder="è¯·è¾“å…¥æˆ–ç²˜è´´ç¬¬äºŒæ®µæ–‡æœ¬..."></textarea>
                </div>
            </div>

            <!-- æ§åˆ¶æŒ‰é’® -->
            <div class="control-section">
                <button class="control-btn primary" onclick="compareTexts()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        <path d="M12 8v4l3 3"/>
                    </svg>
                    å¼€å§‹æ¯”å¯¹
                </button>
                <button class="control-btn secondary" onclick="clearTexts()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                    </svg>
                    æ¸…ç©ºæ–‡æœ¬
                </button>
                <button class="control-btn warning" onclick="swapTexts()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 8l4 4-4 4M7 8l-4 4 4 4M14 4l-4 16"/>
                    </svg>
                    äº¤æ¢æ–‡æœ¬
                </button>
            </div>

            <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
            <div class="result-section" id="resultSection">
                <!-- æ‘˜è¦ä¿¡æ¯ -->
                <div class="summary-bar">
                    <div class="similarity-display">
                        <div class="similarity-circle">
                            <svg width="100%" height="100%" viewBox="0 0 42 42">
                                <circle class="circle-bg" cx="21" cy="21" r="15.9155"></circle>
                                <circle class="circle-progress" cx="21" cy="21" r="15.9155" id="progressCircle"></circle>
                            </svg>
                            <div class="similarity-percent" id="similarityPercent">
                                0<span>%</span>
                            </div>
                        </div>
                        <div class="similarity-info">
                            <div class="similarity-value" id="similarityValue">0%</div>
                            <div class="similarity-label" id="similarityLabel">ç›¸ä¼¼åº¦</div>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalChars">0</div>
                            <div class="stat-label">æ€»å­—ç¬¦æ•°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="sameChars">0</div>
                            <div class="stat-label">ç›¸åŒå­—ç¬¦æ•°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="diffChars">0</div>
                            <div class="stat-label">ä¸åŒå­—ç¬¦æ•°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="diffLines">0</div>
                            <div class="stat-label">å·®å¼‚è¡Œæ•°</div>
                        </div>
                    </div>
                </div>

                <!-- é«˜äº®æ–‡æœ¬å±•ç¤º -->
                <div class="highlight-section">
                    <div class="highlight-header">
                        <h3>æ–‡æœ¬å·®å¼‚å¯¹æ¯”</h3>
                        <div class="legend">
                            <div class="legend-item">
                                <div class="legend-color same"></div>
                                <div>ç›¸åŒå†…å®¹</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color diff"></div>
                                <div>ä¸åŒå†…å®¹</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-display-area">
                        <div class="text-display-container">
                            <div class="text-display-header">
                                <div class="text-display-title">æ–‡æœ¬1</div>
                                <div class="text-display-count" id="text1-result-count">0 å­—ç¬¦</div>
                            </div>
                            <div class="text-display" id="highlightedText1">
                                <div class="empty-state">æ¯”å¯¹åå°†æ˜¾ç¤ºé«˜äº®æ–‡æœ¬</div>
                            </div>
                        </div>
                        
                        <div class="text-display-container">
                            <div class="text-display-header">
                                <div class="text-display-title">æ–‡æœ¬2</div>
                                <div class="text-display-count" id="text2-result-count">0 å­—ç¬¦</div>
                            </div>
                            <div class="text-display" id="highlightedText2">
                                <div class="empty-state">æ¯”å¯¹åå°†æ˜¾ç¤ºé«˜äº®æ–‡æœ¬</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- åº•éƒ¨ä¿¡æ¯ -->
                <div class="footer-info">
                    <p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong> æ¯”å¯¹ç»“æœä¸­ï¼Œ<span class="diff-same" style="padding: 2px 4px;">ç›¸åŒå†…å®¹</span>ä¼šä»¥ç»¿è‰²èƒŒæ™¯é«˜äº®æ˜¾ç¤ºï¼Œ<span class="diff-different" style="padding: 2px 4px;">ä¸åŒå†…å®¹</span>ä¼šä»¥çº¢è‰²èƒŒæ™¯é«˜äº®æ˜¾ç¤ºã€‚ç›¸ä¼¼åº¦åŸºäºå­—ç¬¦çº§åˆ«çš„æ¯”è¾ƒè®¡ç®—ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ›´æ–°æ–‡æœ¬è®¡æ•°
        function updateTextCount() {
            const text1 = document.getElementById('text1');
            const text2 = document.getElementById('text2');
            const count1 = document.getElementById('text1-count');
            const count2 = document.getElementById('text2-count');
            
            count1.textContent = `${text1.value.length} å­—ç¬¦`;
            count2.textContent = `${text2.value.length} å­—ç¬¦`;
        }
        
        // ç›‘å¬æ–‡æœ¬è¾“å…¥
        document.getElementById('text1').addEventListener('input', updateTextCount);
        document.getElementById('text2').addEventListener('input', updateTextCount);
        
        /**
         * è®¡ç®—ä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼åº¦
         */
        function calculateSimilarity(text1, text2) {
            if (!text1 && !text2) return 100;
            if (!text1 || !text2) return 0;
            
            // ä½¿ç”¨æ”¹è¿›çš„ç›¸ä¼¼åº¦ç®—æ³•ï¼ˆè€ƒè™‘å­—ç¬¦å’Œè¯åºï¼‰
            const longer = text1.length > text2.length ? text1 : text2;
            const shorter = text1.length > text2.length ? text2 : text1;
            
            // è®¡ç®—ç¼–è¾‘è·ç¦»
            const dp = Array(shorter.length + 1).fill().map(() => Array(longer.length + 1).fill(0));
            
            for (let i = 0; i <= shorter.length; i++) dp[i][0] = i;
            for (let j = 0; j <= longer.length; j++) dp[0][j] = j;
            
            for (let i = 1; i <= shorter.length; i++) {
                for (let j = 1; j <= longer.length; j++) {
                    const cost = shorter[i - 1] === longer[j - 1] ? 0 : 1;
                    dp[i][j] = Math.min(
                        dp[i - 1][j] + 1,
                        dp[i][j - 1] + 1,
                        dp[i - 1][j - 1] + cost
                    );
                }
            }
            
            const distance = dp[shorter.length][longer.length];
            const maxLength = Math.max(text1.length, text2.length);
            
            const similarity = maxLength === 0 ? 100 : ((maxLength - distance) / maxLength) * 100;
            return Math.round(similarity * 100) / 100;
        }
        
        /**
         * ç”Ÿæˆé«˜äº®æ˜¾ç¤ºçš„HTMLï¼ˆæ”¹è¿›ç®—æ³•ï¼‰
         */
        function highlightDifferences(text1, text2) {
            // æŒ‰è¡Œåˆ†å‰²æ–‡æœ¬
            const lines1 = text1.split('\n');
            const lines2 = text2.split('\n');
            
            let result1 = [];
            let result2 = [];
            let diffLines = 0;
            
            const maxLines = Math.max(lines1.length, lines2.length);
            
            for (let i = 0; i < maxLines; i++) {
                const line1 = lines1[i] || '';
                const line2 = lines2[i] || '';
                
                // æ¯”è¾ƒè¡Œå†…å®¹
                if (line1 === line2) {
                    // ç›¸åŒè¡Œï¼Œæ·»åŠ è¡Œå·å’Œå†…å®¹
                    result1.push(`<div class="line"><span class="diff-same">${escapeHtml(line1)}</span></div>`);
                    result2.push(`<div class="line"><span class="diff-same">${escapeHtml(line2)}</span></div>`);
                } else {
                    // ä¸åŒè¡Œï¼Œéœ€è¦é€å­—ç¬¦æ¯”è¾ƒ
                    diffLines++;
                    const highlighted1 = highlightLineDifferences(line1, line2, 'text1');
                    const highlighted2 = highlightLineDifferences(line2, line1, 'text2');
                    
                    result1.push(`<div class="line">${highlighted1}</div>`);
                    result2.push(`<div class="line">${highlighted2}</div>`);
                }
            }
            
            return {
                html1: result1.join(''),
                html2: result2.join(''),
                diffLines
            };
        }
        
        /**
         * é«˜äº®è¡Œå†…å·®å¼‚
         */
        function highlightLineDifferences(line1, line2, source) {
            if (!line1 && !line2) return '';
            if (!line1) return `<span class="diff-different">${escapeHtml(line2)}</span>`;
            if (!line2) return `<span class="diff-different">${escapeHtml(line1)}</span>`;
            
            // ç®€å•çš„é€å­—ç¬¦æ¯”è¾ƒ
            let result = '';
            const maxLength = Math.max(line1.length, line2.length);
            
            for (let i = 0; i < maxLength; i++) {
                const char1 = line1[i] || '';
                const char2 = line2[i] || '';
                
                if (char1 === char2) {
                    result += `<span class="diff-same">${escapeHtml(char1)}</span>`;
                } else {
                    result += `<span class="diff-different">${escapeHtml(char1)}</span>`;
                }
            }
            
            return result;
        }
        
        /**
         * è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
         */
        function calculateStatistics(text1, text2) {
            const totalChars = text1.length + text2.length;
            
            // è®¡ç®—ç›¸åŒå­—ç¬¦æ•°
            let sameChars = 0;
            const minLength = Math.min(text1.length, text2.length);
            
            for (let i = 0; i < minLength; i++) {
                if (text1[i] === text2[i]) {
                    sameChars++;
                }
            }
            
            const diffChars = totalChars - (sameChars * 2);
            
            return {
                totalChars,
                sameChars,
                diffChars: Math.max(0, diffChars)
            };
        }
        
        /**
         * HTMLç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
         */
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        /**
         * æ›´æ–°åœ†å½¢è¿›åº¦æ¡
         */
        function updateProgressCircle(percent) {
            const circle = document.getElementById('progressCircle');
            const radius = 15.9155;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (percent / 100) * circumference;
            
            circle.style.strokeDasharray = `${circumference} ${circumference}`;
            circle.style.strokeDashoffset = offset;
            
            // æ ¹æ®ç›¸ä¼¼åº¦è®¾ç½®ä¸åŒçš„é¢œè‰²
            if (percent >= 90) {
                circle.style.stroke = '#4CAF50';
            } else if (percent >= 70) {
                circle.style.stroke = '#8BC34A';
            } else if (percent >= 50) {
                circle.style.stroke = '#FFC107';
            } else if (percent >= 30) {
                circle.style.stroke = '#FF9800';
            } else {
                circle.style.stroke = '#F44336';
            }
        }
        
        /**
         * è·å–ç›¸ä¼¼åº¦æè¿°
         */
        function getSimilarityDescription(percent) {
            if (percent >= 95) return 'å‡ ä¹å®Œå…¨ç›¸åŒ';
            if (percent >= 85) return 'éå¸¸ç›¸ä¼¼';
            if (percent >= 70) return 'é«˜åº¦ç›¸ä¼¼';
            if (percent >= 55) return 'æ¯”è¾ƒç›¸ä¼¼';
            if (percent >= 40) return 'éƒ¨åˆ†ç›¸ä¼¼';
            if (percent >= 25) return 'ç•¥æœ‰ç›¸ä¼¼';
            if (percent >= 10) return 'å·®å¼‚è¾ƒå¤§';
            return 'å®Œå…¨ä¸åŒ';
        }
        
        /**
         * ä¸»æ¯”å¯¹å‡½æ•°
         */
        function compareTexts() {
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è¾“å…¥
            if (!text1 && !text2) {
                alert('è¯·è¾“å…¥è¦æ¯”è¾ƒçš„æ–‡æœ¬ï¼');
                return;
            }
            
            // è®¡ç®—ç›¸ä¼¼åº¦
            const similarity = calculateSimilarity(text1, text2);
            
            // ç”Ÿæˆé«˜äº®æ–‡æœ¬
            const highlighted = highlightDifferences(text1, text2);
            
            // è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
            const stats = calculateStatistics(text1, text2);
            
            // æ›´æ–°UI
            document.getElementById('similarityValue').textContent = similarity + '%';
            document.getElementById('similarityPercent').innerHTML = `${Math.round(similarity)}<span>%</span>`;
            document.getElementById('similarityLabel').textContent = getSimilarityDescription(similarity);
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            document.getElementById('totalChars').textContent = stats.totalChars;
            document.getElementById('sameChars').textContent = stats.sameChars;
            document.getElementById('diffChars').textContent = stats.diffChars;
            document.getElementById('diffLines').textContent = highlighted.diffLines;
            
            // æ›´æ–°æ–‡æœ¬æ˜¾ç¤º
            document.getElementById('highlightedText1').innerHTML = highlighted.html1 || '<div class="empty-state">æ— å†…å®¹</div>';
            document.getElementById('highlightedText2').innerHTML = highlighted.html2 || '<div class="empty-state">æ— å†…å®¹</div>';
            
            // æ›´æ–°ç»“æœè®¡æ•°
            document.getElementById('text1-result-count').textContent = `${text1.length} å­—ç¬¦`;
            document.getElementById('text2-result-count').textContent = `${text2.length} å­—ç¬¦`;
            
            // æ›´æ–°è¿›åº¦æ¡
            updateProgressCircle(similarity);
            
            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            const resultSection = document.getElementById('resultSection');
            resultSection.classList.add('active');
            
            // å¹³æ»‘æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            setTimeout(() => {
                resultSection.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            }, 100);
        }
        
        /**
         * æ¸…ç©ºæ–‡æœ¬
         */
        function clearTexts() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºä¸¤æ®µæ–‡æœ¬å—ï¼Ÿ')) {
                document.getElementById('text1').value = '';
                document.getElementById('text2').value = '';
                document.getElementById('resultSection').classList.remove('active');
                updateTextCount();
            }
        }
        
        /**
         * äº¤æ¢æ–‡æœ¬
         */
        function swapTexts() {
            const text1 = document.getElementById('text1');
            const text2 = document.getElementById('text2');
            const temp = text1.value;
            text1.value = text2.value;
            text2.value = temp;
            updateTextCount();
            
            // å¦‚æœç»“æœåŒºåŸŸå·²æ˜¾ç¤ºï¼Œé‡æ–°æ¯”å¯¹
            if (document.getElementById('resultSection').classList.contains('active')) {
                compareTexts();
            }
        }
        
        /**
         * é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
         */
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ–‡æœ¬è®¡æ•°
            updateTextCount();
            
            // ä¸ºæ–‡æœ¬æ¡†æ·»åŠ å¿«æ·é”®æ”¯æŒ
            document.getElementById('text1').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    compareTexts();
                }
            });
            
            document.getElementById('text2').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    compareTexts();
                }
            });
            
            // è®¾ç½®åˆå§‹è¿›åº¦æ¡
            updateProgressCircle(0);
            
            // è‡ªåŠ¨è°ƒæ•´æ–‡æœ¬æ¡†é«˜åº¦
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                textarea.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = Math.min(this.scrollHeight, 500) + 'px';
                });
            });
            
            // æ·»åŠ ç¤ºä¾‹æ–‡æœ¬ï¼ˆå¯é€‰ï¼‰
            const addExampleBtn = document.createElement('button');
            addExampleBtn.className = 'control-btn secondary';
            addExampleBtn.style.marginLeft = 'auto';
            addExampleBtn.style.marginRight = '10px';
            addExampleBtn.innerHTML = `
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                    <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                </svg>
                åŠ è½½ç¤ºä¾‹
            `;
            addExampleBtn.onclick = function() {
                document.getElementById('text1').value = `æ–‡æœ¬æ¯”å¯¹å·¥å…·ç¤ºä¾‹

åŠŸèƒ½è¯´æ˜ï¼š
1. æ¯”è¾ƒä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼åº¦
2. é«˜äº®æ˜¾ç¤ºç›¸åŒå’Œä¸åŒçš„éƒ¨åˆ†
3. æä¾›è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯

è¿™ä¸ªå·¥å…·éå¸¸å®ç”¨ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°æ–‡æœ¬å·®å¼‚ã€‚`;
                
                document.getElementById('text2').value = `æ–‡æœ¬æ¯”å¯¹å·¥å…·ç¤ºä¾‹

åŠŸèƒ½ä»‹ç»ï¼š
1. æ¯”è¾ƒä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼ç¨‹åº¦
2. é«˜äº®æ˜¾ç¤ºç›¸åŒå’Œä¸åŒçš„å†…å®¹
3. æä¾›è¯¦ç»†çš„ç»Ÿè®¡æ•°æ®

è¯¥å·¥å…·éå¸¸å®ç”¨ï¼Œå¯ä»¥å¸®åŠ©ä½¿ç”¨è€…å¿«é€Ÿå‘ç°æ–‡æœ¬å·®å¼‚ã€‚`;
                
                updateTextCount();
                compareTexts();
            };
            
            document.querySelector('.control-section').prepend(addExampleBtn);
        });
    </script>
</body>
</html>