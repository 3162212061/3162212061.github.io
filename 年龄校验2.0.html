<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿é™©äº§å“å¹´é¾„æ ¡éªŒå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .header p {
            font-size: 15px;
            opacity: 0.95;
            line-height: 1.6;
        }

        .content {
            padding: 40px 30px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            border-left: 5px solid #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 20px;
            color: #333;
            margin-bottom: 25px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .section-title .icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: 600;
            font-size: 15px;
        }

        .input-group label .required {
            color: #dc3545;
            margin-left: 3px;
        }

        .mode-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .mode-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .mode-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
        }

        .input-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        input[type="number"],
        input[type="date"] {
            flex: 1;
            min-width: 150px;
            padding: 14px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
            background: white;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        input:hover {
            border-color: #b8c5f2;
        }

        .unit-text {
            color: #666;
            font-size: 14px;
            white-space: nowrap;
            font-weight: 500;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button .btn-icon {
            font-size: 18px;
        }

        .result-box {
            margin-top: 30px;
            padding: 25px;
            border-radius: 10px;
            display: none;
            animation: slideIn 0.4s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-box.success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 2px solid #28a745;
        }

        .result-box.error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 2px solid #dc3545;
        }

        .result-box.info {
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
            border: 2px solid #17a2b8;
        }

        .result-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 2px dashed rgba(0,0,0,0.1);
        }

        .result-title .status-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 18px;
            font-weight: bold;
        }

        .result-box.success .status-icon {
            background: #28a745;
            color: white;
        }

        .result-box.error .status-icon {
            background: #dc3545;
            color: white;
        }

        .result-box.info .status-icon {
            background: #17a2b8;
            color: white;
        }

        .result-detail {
            line-height: 2;
        }

        .result-detail p {
            margin-bottom: 12px;
            font-size: 15px;
        }

        .result-detail strong {
            color: #333;
            display: inline-block;
            min-width: 140px;
        }

        .highlight {
            font-weight: bold;
            font-size: 16px;
            color: #667eea;
            padding: 2px 8px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 4px;
        }

        .result-box.success .highlight {
            color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }

        .result-box.error .highlight {
            color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        .divider {
            margin: 20px 0;
            border: none;
            border-top: 2px dashed rgba(0,0,0,0.15);
        }

        .conclusion {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
        }

        .result-box.success .conclusion {
            background: rgba(40, 167, 69, 0.15);
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .result-box.error .conclusion {
            background: rgba(220, 53, 69, 0.15);
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .result-box.info .conclusion {
            background: rgba(23, 162, 184, 0.15);
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .tip {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin-top: 30px;
            border-radius: 8px;
            font-size: 14px;
            color: #856404;
            line-height: 1.8;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.2);
        }

        .tip strong {
            font-size: 15px;
            display: block;
            margin-bottom: 10px;
        }

        .tip ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .tip li {
            margin-bottom: 8px;
        }

        .age-range-display {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 2px solid #e0e0e0;
        }

        .age-range-display .range-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .age-range-display .range-label {
            font-weight: 600;
            color: #555;
            min-width: 120px;
        }

        .age-range-display .range-value {
            font-weight: bold;
            color: #667eea;
            font-size: 16px;
        }

        .custom-date-toggle {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #667eea;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .custom-date-container {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #f1f3f5;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .boundary-dates {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #e0e0e0;
        }

        .boundary-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .boundary-item.min {
            border-left-color: #28a745;
        }

        .boundary-item.max {
            border-left-color: #dc3545;
        }

        .boundary-icon {
            font-size: 24px;
            margin-right: 15px;
            width: 40px;
            text-align: center;
        }

        .boundary-content {
            flex: 1;
        }

        .boundary-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
            color: #333;
        }

        .boundary-date {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin: 5px 0;
        }

        .boundary-item.min .boundary-date {
            color: #28a745;
        }

        .boundary-item.max .boundary-date {
            color: #dc3545;
        }

        .boundary-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
        }

        .boundary-age-detail {
            font-size: 16px;
            font-weight: bold;
            margin: 8px 0;
            color: #333;
        }

        .boundary-note {
            font-size: 14px;
            color: #666;
            font-style: italic;
            margin-top: 5px;
        }

        .logic-comparison {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #667eea;
        }

        .logic-comparison-title {
            font-weight: bold;
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .logic-comparison-title .icon {
            margin-right: 8px;
            font-size: 18px;
        }

        .logic-comparison-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .content {
                padding: 25px 20px;
            }

            .section {
                padding: 20px;
            }

            .input-row {
                flex-direction: column;
                align-items: stretch;
            }

            input[type="number"],
            input[type="date"] {
                min-width: 100%;
            }

            .button-group {
                flex-direction: column;
            }

            .result-detail strong {
                min-width: auto;
                display: block;
                margin-bottom: 5px;
            }

            .boundary-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .boundary-icon {
                margin-right: 0;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ ä¿é™©äº§å“å¹´é¾„æ ¡éªŒå·¥å…·</h1>
            <p>ä¸“ä¸šçš„æŠ•ä¿å¹´é¾„è®¡ç®—ä¸æ ¡éªŒç³»ç»Ÿ | æ”¯æŒå‘¨å²å’Œå¤©æ•°è®¡ç®— | ç¬¦åˆä¿é™©è¡Œä¸šæ ‡å‡†</p>
        </div>

        <div class="content">
            <div class="section">
                <div class="section-title">
                    <span class="icon">ğŸ“‹</span>
                    å¹´é¾„æ ¡éªŒä¸å‡ºç”Ÿæ—¥æœŸåŒºé—´è®¡ç®—
                </div>
                
                <!-- è®¡ç®—åŸºå‡†æ—¥æœŸ -->
                <div class="input-group">
                    <label>
                        <span>è®¡ç®—åŸºå‡†æ—¥æœŸ</span>
                        <span style="color: #999; font-weight: normal; font-size: 13px;">ï¼ˆé»˜è®¤ä½¿ç”¨å½“å‰æ—¥æœŸï¼‰</span>
                    </label>
                    <div class="custom-date-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="customDateToggle" onchange="toggleCustomDate()">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>ä½¿ç”¨è‡ªå®šä¹‰åŸºå‡†æ—¥æœŸ</span>
                    </div>
                    <div class="custom-date-container" id="customDateContainer">
                        <input type="date" id="customDate" style="width: 100%;">
                        <div style="font-size: 13px; color: #666; margin-top: 8px;">
                            ğŸ’¡ è®¾ç½®ä¸€ä¸ªç‰¹å®šæ—¥æœŸä½œä¸ºå¹´é¾„è®¡ç®—çš„åŸºå‡†ï¼Œé€‚ç”¨äºå†å²æˆ–æœªæ¥æŠ•ä¿åœºæ™¯
                        </div>
                    </div>
                </div>
                
                <!-- è¾“å…¥æ¨¡å¼åˆ‡æ¢ -->
                <div class="input-group">
                    <label>
                        <span>å¹´é¾„è¾“å…¥æ¨¡å¼</span>
                    </label>
                    <div class="mode-switcher">
                        <button class="mode-btn active" onclick="switchMode('year')">æŒ‰å‘¨å²è¾“å…¥</button>
                        <button class="mode-btn" onclick="switchMode('day')">æŒ‰å¤©æ•°è¾“å…¥</button>
                    </div>
                </div>
                
                <!-- äº§å“å¹´é¾„è¦æ±‚ -->
                <div class="input-group" id="yearModeInputs">
                    <label>
                        <span>äº§å“æŠ•ä¿å¹´é¾„è¦æ±‚</span>
                        <span class="required">*</span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="minAge" placeholder="æœ€å°å¹´é¾„" value="20" min="0" max="150">
                        <span class="unit-text">å‘¨å²ï¼ˆå«ï¼‰</span>
                        <span class="unit-text">è‡³</span>
                        <input type="number" id="maxAge" placeholder="æœ€å¤§å¹´é¾„" value="45" min="0" max="150">
                        <span class="unit-text">å‘¨å²ï¼ˆå«ï¼‰</span>
                    </div>
                </div>

                <!-- æŒ‰å¤©æ•°è¾“å…¥æ¨¡å¼ -->
                <div class="input-group" id="dayModeInputs" style="display: none;">
                    <label>
                        <span>äº§å“æŠ•ä¿å¹´é¾„è¦æ±‚</span>
                        <span class="required">*</span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="minAgeDays" placeholder="æœ€å°å¤©æ•°" value="7" min="0" max="36500">
                        <span class="unit-text">å¤©ï¼ˆå«ï¼‰</span>
                        <span class="unit-text">è‡³</span>
                        <input type="number" id="maxAgeDays" placeholder="æœ€å¤§å¹´é¾„" value="70" min="0" max="150">
                        <span class="unit-text">å‘¨å²ï¼ˆå«ï¼‰</span>
                    </div>
                    <div style="font-size: 13px; color: #666; margin-top: 8px;">
                        ğŸ’¡ é€‚ç”¨äºæ–°ç”Ÿå„¿ä¿é™©ç­‰éœ€è¦ç²¾ç¡®åˆ°å¤©çš„åœºæ™¯ï¼Œå¦‚"å‡ºç”Ÿæ»¡7å¤©è‡³70å‘¨å²"
                    </div>
                </div>

                <!-- æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸï¼ˆå¯é€‰ï¼‰ -->
                <div class="input-group">
                    <label>
                        <span>æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸ</span>
                        <span style="color: #999; font-weight: normal; font-size: 13px;">ï¼ˆé€‰å¡«ï¼Œç”¨äºæ ¡éªŒå…·ä½“æŠ•ä¿äººï¼‰</span>
                    </label>
                    <input type="date" id="birthDate" style="width: 100%;">
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="button-group">
                    <button onclick="calculateAll()">
                        <span class="btn-icon">ğŸ”</span>
                        <span>å…¨é¢åˆ†æ</span>
                    </button>
                    <button onclick="clearAll()" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                        <span class="btn-icon">ğŸ”„</span>
                        <span>é‡ç½®</span>
                    </button>
                </div>

                <!-- ç»“æœæ˜¾ç¤ºåŒº -->
                <div id="result" class="result-box"></div>

                <!-- ä½¿ç”¨è¯´æ˜ -->
                <div class="tip">
                    <strong>ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</strong>
                    <ul>
                        <li><strong>è®¡ç®—åŸºå‡†æ—¥æœŸï¼š</strong>é»˜è®¤ä½¿ç”¨å½“å‰ç³»ç»Ÿæ—¥æœŸï¼Œå¯åˆ‡æ¢ä¸ºè‡ªå®šä¹‰æ—¥æœŸï¼Œé€‚ç”¨äºå†å²æˆ–æœªæ¥æŠ•ä¿åœºæ™¯ã€‚</li>
                        <li><strong>ä¸¤ç§è¾“å…¥æ¨¡å¼ï¼š</strong>æ”¯æŒ"æŒ‰å‘¨å²è¾“å…¥"å’Œ"æŒ‰å¤©æ•°è¾“å…¥"ä¸¤ç§æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒä¿é™©äº§å“çš„å¹´é¾„è¦æ±‚ã€‚</li>
                        <li><strong>æŒ‰å‘¨å²è¾“å…¥ï¼š</strong>é€‚ç”¨äºå¤§å¤šæ•°ä¿é™©äº§å“ï¼Œè¾“å…¥æœ€å°å’Œæœ€å¤§å‘¨å²å¹´é¾„ã€‚</li>
                        <li><strong>æŒ‰å¤©æ•°è¾“å…¥ï¼š</strong>é€‚ç”¨äºæ–°ç”Ÿå„¿ä¿é™©ç­‰ç‰¹æ®Šåœºæ™¯ï¼Œæœ€å°å¹´é¾„å¯è¾“å…¥å¤©æ•°ï¼Œæœ€å¤§å¹´é¾„è¾“å…¥å‘¨å²ã€‚</li>
                        <li><strong>åŸºç¡€åŠŸèƒ½ï¼š</strong>è¾“å…¥äº§å“å¹´é¾„è¦æ±‚ï¼Œç‚¹å‡»"å…¨é¢åˆ†æ"ï¼Œç³»ç»Ÿå°†è®¡ç®—å‡ºç¬¦åˆè¯¥å¹´é¾„è¦æ±‚çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´ã€‚</li>
                        <li><strong>æ‰©å±•åŠŸèƒ½ï¼š</strong>å¦‚æœéœ€è¦æ ¡éªŒå…·ä½“æŠ•ä¿äººï¼Œå¯ä»¥é¢å¤–å¡«å†™"æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸ"ï¼Œç³»ç»Ÿå°†åŒæ—¶æ˜¾ç¤ºè¯¥æŠ•ä¿äººçš„å¹´é¾„åŠæ˜¯å¦ç¬¦åˆæŠ•ä¿æ¡ä»¶ã€‚</li>
                        <li><strong>è®¡ç®—æ ‡å‡†ï¼š</strong>å¹´é¾„è®¡ç®—ä¸¥æ ¼éµå¾ªä¿é™©è¡Œä¸šæ ‡å‡†çš„å‘¨å²è®¡ç®—æ³•ï¼Œç²¾ç¡®åˆ°å¤©ã€‚ä¾‹å¦‚ï¼š2000å¹´10æœˆ28æ—¥å‡ºç”Ÿçš„äººï¼Œåœ¨2025å¹´10æœˆ27æ—¥ä»ä¸º24å‘¨å²ï¼Œ10æœˆ28æ—¥å½“å¤©æ‰æ»¡25å‘¨å²ã€‚</li>
                        <li><strong>å¹´é¾„åŒ…å«å…³ç³»ï¼š</strong>æœ€å°å¹´é¾„å’Œæœ€å¤§å¹´é¾„å‡ä¸º"å«"ï¼Œå³è¾¹ç•Œå€¼ç¬¦åˆæ¡ä»¶ã€‚ä¾‹å¦‚ï¼š20-45å‘¨å²è¡¨ç¤º20å‘¨å²å’Œ45å‘¨å²çš„æŠ•ä¿äººéƒ½ç¬¦åˆæ¡ä»¶ã€‚</li>
                        <li><strong>å¿«æ·æ“ä½œï¼š</strong>æ‰€æœ‰è¾“å…¥æ¡†æ”¯æŒé”®ç›˜Enteré”®å¿«é€Ÿæäº¤ï¼Œç‚¹å‡»"é‡ç½®"æŒ‰é’®å¯æ¸…ç©ºæ‰€æœ‰è¾“å…¥å’Œç»“æœã€‚</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'year'; // 'year' æˆ– 'day'

        /**
         * é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–è‡ªå®šä¹‰æ—¥æœŸè¾“å…¥æ¡†
         */
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®è‡ªå®šä¹‰æ—¥æœŸè¾“å…¥æ¡†çš„é»˜è®¤å€¼ä¸ºä»Šå¤©
            document.getElementById('customDate').value = formatDate(new Date());
            
            // é”®ç›˜äº‹ä»¶ç›‘å¬ - Enteré”®æäº¤
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calculateAll();
                    }
                });
            });
        });

        /**
         * åˆ‡æ¢è‡ªå®šä¹‰åŸºå‡†æ—¥æœŸæ˜¾ç¤º/éšè—
         */
        function toggleCustomDate() {
            const toggle = document.getElementById('customDateToggle');
            const container = document.getElementById('customDateContainer');
            
            if (toggle.checked) {
                container.style.display = 'block';
            } else {
                container.style.display = 'none';
            }
        }

        /**
         * è·å–è®¡ç®—åŸºå‡†æ—¥æœŸ
         */
        function getReferenceDate() {
            const toggle = document.getElementById('customDateToggle');
            
            if (toggle.checked) {
                const customDateValue = document.getElementById('customDate').value;
                if (customDateValue) {
                    return new Date(customDateValue);
                }
            }
            
            // é»˜è®¤è¿”å›å½“å‰æ—¥æœŸ
            return new Date();
        }

        /**
         * åˆ‡æ¢è¾“å…¥æ¨¡å¼
         */
        function switchMode(mode) {
            currentMode = mode;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ˜¾ç¤º/éšè—å¯¹åº”çš„è¾“å…¥åŒºåŸŸ
            if (mode === 'year') {
                document.getElementById('yearModeInputs').style.display = 'block';
                document.getElementById('dayModeInputs').style.display = 'none';
            } else {
                document.getElementById('yearModeInputs').style.display = 'none';
                document.getElementById('dayModeInputs').style.display = 'block';
            }
            
            // æ¸…ç©ºç»“æœ
            document.getElementById('result').style.display = 'none';
        }

        /**
         * æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY-MM-DD
         */
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        /**
         * æ ¼å¼åŒ–æ—¥æœŸä¸ºä¸­æ–‡æ ¼å¼ YYYYå¹´MMæœˆDDæ—¥
         */
        function formatDateChinese(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }

        /**
         * è®¡ç®—å‘¨å²å¹´é¾„ï¼ˆç²¾ç¡®åˆ°å¤©ï¼‰
         * @param {Date} birthDate - å‡ºç”Ÿæ—¥æœŸ
         * @param {Date} targetDate - ç›®æ ‡æ—¥æœŸï¼ˆé»˜è®¤ä¸ºä»Šå¤©ï¼‰
         * @returns {number} å‘¨å²å¹´é¾„
         */
        function calculateAge(birthDate, targetDate = new Date()) {
            let age = targetDate.getFullYear() - birthDate.getFullYear();
            const monthDiff = targetDate.getMonth() - birthDate.getMonth();
            const dayDiff = targetDate.getDate() - birthDate.getDate();

            // å¦‚æœè¿˜æ²¡åˆ°ç”Ÿæ—¥ï¼Œå¹´é¾„å‡1
            if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {
                age--;
            }

            return age;
        }

        /**
         * è®¡ç®—å¤©æ•°å¹´é¾„
         * @param {Date} birthDate - å‡ºç”Ÿæ—¥æœŸ
         * @param {Date} targetDate - ç›®æ ‡æ—¥æœŸï¼ˆé»˜è®¤ä¸ºä»Šå¤©ï¼‰
         * @returns {number} å¤©æ•°å¹´é¾„
         */
        function calculateAgeInDays(birthDate, targetDate = new Date()) {
            const diffTime = targetDate - birthDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        /**
         * è®¡ç®—æŒ‡å®šå¹´é¾„å¯¹åº”çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´
         * @param {number} age - å¹´é¾„ï¼ˆå‘¨å²ï¼‰
         * @param {Date} referenceDate - å‚è€ƒæ—¥æœŸï¼ˆé»˜è®¤ä¸ºä»Šå¤©ï¼‰
         * @returns {Object} åŒ…å«æœ€æ—©å’Œæœ€æ™šå‡ºç”Ÿæ—¥æœŸ
         */
        function calculateBirthDateRange(age, referenceDate = new Date()) {
            // æœ€æ—©å‡ºç”Ÿæ—¥æœŸï¼šå‚è€ƒæ—¥æœŸå¾€å‰æ¨ age+1 å¹´ï¼Œå†åŠ 1å¤©
            const earliestBirth = new Date(referenceDate);
            earliestBirth.setFullYear(earliestBirth.getFullYear() - age - 1);
            earliestBirth.setDate(earliestBirth.getDate() + 1);

            // æœ€æ™šå‡ºç”Ÿæ—¥æœŸï¼šå‚è€ƒæ—¥æœŸå¾€å‰æ¨ age å¹´
            const latestBirth = new Date(referenceDate);
            latestBirth.setFullYear(latestBirth.getFullYear() - age);

            return {
                earliest: earliestBirth,
                latest: latestBirth
            };
        }

        /**
         * è®¡ç®—æŒ‡å®šå¤©æ•°å¯¹åº”çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´
         * @param {number} days - å¤©æ•°
         * @param {Date} referenceDate - å‚è€ƒæ—¥æœŸï¼ˆé»˜è®¤ä¸ºä»Šå¤©ï¼‰
         * @returns {Object} åŒ…å«æœ€æ—©å’Œæœ€æ™šå‡ºç”Ÿæ—¥æœŸ
         */
        function calculateBirthDateRangeFromDays(days, referenceDate = new Date()) {
            // æœ€æ—©å‡ºç”Ÿæ—¥æœŸï¼šå‚è€ƒæ—¥æœŸå¾€å‰æ¨ days å¤©
            const earliestBirth = new Date(referenceDate);
            earliestBirth.setDate(earliestBirth.getDate() - days);
            
            // æœ€æ™šå‡ºç”Ÿæ—¥æœŸï¼šå‚è€ƒæ—¥æœŸå¾€å‰æ¨ days å¤©ï¼ˆåŒä¸€å¤©ï¼‰
            const latestBirth = new Date(earliestBirth);

            return {
                earliest: earliestBirth,
                latest: latestBirth
            };
        }

        /**
         * è®¡ç®—è¾¹ç•Œæ—¥æœŸ
         * @param {number} minAge - æœ€å°å¹´é¾„
         * @param {number} maxAge - æœ€å¤§å¹´é¾„
         * @param {Date} referenceDate - å‚è€ƒæ—¥æœŸ
         * @param {string} mode - æ¨¡å¼ ('year' æˆ– 'day')
         * @returns {Object} åŒ…å«æœ€å°å’Œæœ€å¤§è¾¹ç•Œæ—¥æœŸ
         */
        function calculateBoundaryDates(minAge, maxAge, referenceDate, mode = 'year') {
            let minBoundaryDate, maxBoundaryDate1, maxBoundaryDate2;
            
            if (mode === 'year') {
                // å‘¨å²æ¨¡å¼
                // æœ€å°å¹´é¾„è¾¹ç•Œï¼šåˆšå¥½æ»¡æœ€å°å¹´é¾„çš„é‚£ä¸€å¤©
                minBoundaryDate = new Date(referenceDate);
                minBoundaryDate.setFullYear(minBoundaryDate.getFullYear() - minAge);
                
                // æœ€å¤§å¹´é¾„è¾¹ç•Œ1ï¼ˆé€»è¾‘1ï¼‰ï¼šåˆšå¥½æ»¡æœ€å¤§å¹´é¾„+1å²çš„å‰ä¸€å¤©ï¼ˆå³æœ€å¤§å¹´é¾„364å¤©ï¼‰
                maxBoundaryDate1 = new Date(referenceDate);
                maxBoundaryDate1.setFullYear(maxBoundaryDate1.getFullYear() - maxAge - 1);
                maxBoundaryDate1.setDate(maxBoundaryDate1.getDate() + 1);
                
                // æœ€å¤§å¹´é¾„è¾¹ç•Œ2ï¼ˆé€»è¾‘2ï¼‰ï¼šåˆšå¥½æ»¡æœ€å¤§å¹´é¾„çš„é‚£ä¸€å¤©
                maxBoundaryDate2 = new Date(referenceDate);
                maxBoundaryDate2.setFullYear(maxBoundaryDate2.getFullYear() - maxAge);
            } else {
                // å¤©æ•°æ¨¡å¼
                // æœ€å°å¹´é¾„è¾¹ç•Œï¼šåˆšå¥½æ»¡æœ€å°å¤©æ•°çš„å‰ä¸€å¤©
                minBoundaryDate = new Date(referenceDate);
                minBoundaryDate.setDate(minBoundaryDate.getDate() - minAge);
                
                // æœ€å¤§å¹´é¾„è¾¹ç•Œ1ï¼ˆé€»è¾‘1ï¼‰ï¼šåˆšå¥½æ»¡æœ€å¤§å¹´é¾„+1å²çš„å‰ä¸€å¤©ï¼ˆå³æœ€å¤§å¹´é¾„364å¤©ï¼‰
                maxBoundaryDate1 = new Date(referenceDate);
                maxBoundaryDate1.setFullYear(maxBoundaryDate1.getFullYear() - maxAge - 1);
                maxBoundaryDate1.setDate(maxBoundaryDate1.getDate() + 1);
                
                // æœ€å¤§å¹´é¾„è¾¹ç•Œ2ï¼ˆé€»è¾‘2ï¼‰ï¼šåˆšå¥½æ»¡æœ€å¤§å¹´é¾„çš„é‚£ä¸€å¤©
                maxBoundaryDate2 = new Date(referenceDate);
                maxBoundaryDate2.setFullYear(maxBoundaryDate2.getFullYear() - maxAge);
            }
            
            return {
                minBoundaryDate,
                maxBoundaryDate1, // é€»è¾‘1ï¼šæœ€å¤§å¹´é¾„364å¤©
                maxBoundaryDate2  // é€»è¾‘2ï¼šæœ€å¤§å¹´é¾„0å¤©
            };
        }

        /**
         * å°†å¹´é¾„è½¬æ¢ä¸ºå¤©æ•°ï¼ˆç”¨äºæ¯”è¾ƒï¼‰
         * å‚è€ƒ"å¤©æ•°æ ¡éªŒå‚è€ƒ.html"ä¸­çš„é€»è¾‘
         */
        function convertToDays(value, unit, referenceDate) {
            if (unit === 'days') {
                return value;
            } else {
                // å‘¨å²è½¬æ¢ä¸ºå¤©æ•°ï¼ˆè¿‘ä¼¼å€¼ï¼š1å¹´=365.25å¤©ï¼‰
                return value * 365.25;
            }
        }

        /**
         * æ˜¾ç¤ºç»“æœ
         */
        function showResult(element, type, content) {
            element.className = `result-box ${type}`;
            element.innerHTML = content;
            element.style.display = 'block';
            element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        /**
         * å…¨é¢åˆ†æè®¡ç®—
         */
        function calculateAll() {
            const birthDateInput = document.getElementById('birthDate').value;
            const resultDiv = document.getElementById('result');
            const referenceDate = getReferenceDate(); // è·å–åŸºå‡†æ—¥æœŸ

            let minAge, maxAge, resultHTML, validBirthStart, validBirthEnd;

            if (currentMode === 'year') {
                // å‘¨å²æ¨¡å¼
                minAge = parseInt(document.getElementById('minAge').value);
                maxAge = parseInt(document.getElementById('maxAge').value);

                // è¾“å…¥éªŒè¯
                if (isNaN(minAge) || isNaN(maxAge)) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„æ•°å€¼ï¼</p>
                        </div>
                    `);
                    return;
                }

                if (minAge < 0 || maxAge < 0) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°ï¼</p>
                        </div>
                    `);
                    return;
                }

                if (minAge > maxAge) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>æœ€å°å¹´é¾„ï¼ˆ${minAge}å‘¨å²ï¼‰ä¸èƒ½å¤§äºæœ€å¤§å¹´é¾„ï¼ˆ${maxAge}å‘¨å²ï¼‰ï¼</p>
                        </div>
                    `);
                    return;
                }

                // è®¡ç®—å‡ºç”Ÿæ—¥æœŸåŒºé—´
                const minAgeRange = calculateBirthDateRange(minAge, referenceDate);
                const maxAgeRange = calculateBirthDateRange(maxAge, referenceDate);

                // ç¬¦åˆæ¡ä»¶çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´
                validBirthStart = maxAgeRange.earliest; // æœ€å¤§å¹´é¾„çš„æœ€æ—©å‡ºç”Ÿæ—¥æœŸ
                validBirthEnd = minAgeRange.latest;     // æœ€å°å¹´é¾„çš„æœ€æ™šå‡ºç”Ÿæ—¥æœŸ

                // è®¡ç®—è¾¹ç•Œæ—¥æœŸ
                const boundaryDates = calculateBoundaryDates(minAge, maxAge, referenceDate, 'year');

                resultHTML = `
                    <div class="result-title">
                        <span class="status-icon">ğŸ“Š</span>
                        åˆ†æç»“æœï¼ˆå‘¨å²æ¨¡å¼ï¼‰
                    </div>
                    <div class="result-detail">
                        <p><strong>è®¡ç®—åŸºå‡†æ—¥æœŸï¼š</strong><span class="highlight">${formatDate(referenceDate)}</span></p>
                        <p><strong>äº§å“å¹´é¾„è¦æ±‚ï¼š</strong><span class="highlight">${minAge}å‘¨å²ï¼ˆå«ï¼‰- ${maxAge}å‘¨å²ï¼ˆå«ï¼‰</span></p>
                        
                        <hr class="divider">
                        
                        <div class="boundary-dates">
                            <p style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ¯ å…³é”®è¾¹ç•Œæ—¥æœŸ
                            </p>
                            <div class="boundary-item min">
                                <div class="boundary-icon">ğŸ‚</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å°è´­ä¹°å¹´é¾„</div>
                                    <div class="boundary-age-detail">å‘¨å²ï¼š${minAge}å²0å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.minBoundaryDate)}ï¼ˆæˆ–æ›´æ—©ï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ—©å‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} å·²æ»¡ ${minAge} å‘¨å²ï¼Œç¬¦åˆæœ€å°æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                            <div class="boundary-item max">
                                <div class="boundary-icon">ğŸ¯</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å¤§è´­ä¹°å¹´é¾„ï¼ˆé€»è¾‘1ï¼‰</div>
                                    <div class="boundary-age-detail">å‘¨å²ï¼š${maxAge}å²364å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.maxBoundaryDate1)}ï¼ˆæˆ–æ›´æ™šï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ™šå‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} æœªæ»¡ ${maxAge + 1} å‘¨å²ï¼Œç¬¦åˆæœ€å¤§æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                            <div class="boundary-item max">
                                <div class="boundary-icon">ğŸ¯</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å¤§è´­ä¹°å¹´é¾„ï¼ˆé€»è¾‘2ï¼‰</div>
                                    <div class="boundary-age-detail">å‘¨å²ï¼š${maxAge}å²0å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.maxBoundaryDate2)}ï¼ˆæˆ–æ›´æ™šï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ™šå‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} åˆšå¥½åˆ°è¾¾ ${maxAge} å‘¨å²ï¼Œç¬¦åˆæœ€å¤§æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="logic-comparison">
                            <div class="logic-comparison-title">
                                <span class="icon">ğŸ“</span>
                                ä¸¤ç§é€»è¾‘å¯¹æ¯”è¯´æ˜
                            </div>
                            <div class="logic-comparison-desc">
                                <p><strong>é€»è¾‘1ï¼š</strong>ä¸¥æ ¼éµå¾ªä¿é™©è¡Œä¸šæ ‡å‡†ï¼Œæœ€å¤§å¹´é¾„ä¸º"æœªæ»¡ä¸‹ä¸€å‘¨å²"ï¼Œå³ ${maxAge} å² 364 å¤©ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„æ ‡å‡†ã€‚</p>
                                <p><strong>é€»è¾‘2ï¼š</strong>å°†æœ€å¤§å¹´é¾„ç†è§£ä¸º"åˆšå¥½æ»¡ ${maxAge} å‘¨å²"ï¼Œå³ ${maxAge} å² 0 å¤©ã€‚æŸäº›äº§å“å¯èƒ½é‡‡ç”¨æ­¤æ ‡å‡†ã€‚</p>
                                <p><strong>æ¨èä½¿ç”¨ï¼š</strong>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¿é™©è¡Œä¸šé‡‡ç”¨<strong>é€»è¾‘1</strong>ä½œä¸ºæ ‡å‡†è®¡ç®—æ–¹æ³•ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒå…·ä½“ä¿é™©äº§å“çš„æ¡æ¬¾è¯´æ˜ã€‚</p>
                            </div>
                        </div>
                        
                        <hr class="divider">
                        
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid #e0e0e0;">
                            <p style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ“… ç¬¦åˆæŠ•ä¿æ¡ä»¶çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´ï¼ˆåŸºäºé€»è¾‘1ï¼‰
                            </p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #667eea;">
                                <p style="font-size: 18px; font-weight: bold; color: #667eea; text-align: center; line-height: 1.8;">
                                    ${formatDate(validBirthStart)} è‡³ ${formatDate(validBirthEnd)}
                                </p>
                            </div>
                            <p style="margin-top: 15px; color: #666; font-size: 14px; line-height: 1.6;">
                                <strong>è¯´æ˜ï¼š</strong>å‡ºç”Ÿæ—¥æœŸåœ¨æ­¤åŒºé—´å†…ï¼ˆå«è¾¹ç•Œæ—¥æœŸï¼‰çš„æŠ•ä¿äººï¼Œåœ¨ ${formatDate(referenceDate)} è¿™ä¸€å¤©çš„å¹´é¾„ç¬¦åˆ ${minAge}-${maxAge} å‘¨å²çš„æŠ•ä¿è¦æ±‚ã€‚
                            </p>
                        </div>

                        <hr class="divider">

                        <div class="age-range-display">
                            <p style="font-size: 15px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ” è¯¦ç»†å¹´é¾„åŒºé—´åˆ†è§£
                            </p>
                            <div class="range-item">
                                <span class="range-label">æœ€å°å¹´é¾„ï¼ˆ${minAge}å‘¨å²ï¼‰ï¼š</span>
                                <span class="range-value">${formatDate(minAgeRange.earliest)} ~ ${formatDate(minAgeRange.latest)}</span>
                            </div>
                            <div class="range-item">
                                <span class="range-label">æœ€å¤§å¹´é¾„ï¼ˆ${maxAge}å‘¨å²ï¼‰ï¼š</span>
                                <span class="range-value">${formatDate(maxAgeRange.earliest)} ~ ${formatDate(maxAgeRange.latest)}</span>
                            </div>
                        </div>
                `;
            } else {
                // å¤©æ•°æ¨¡å¼ - ä¿®å¤æ ¡éªŒé€»è¾‘
                const minAgeDays = parseInt(document.getElementById('minAgeDays').value);
                const maxAgeYears = parseInt(document.getElementById('maxAgeDays').value);

                // è¾“å…¥éªŒè¯
                if (isNaN(minAgeDays) || isNaN(maxAgeYears)) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„æ•°å€¼ï¼</p>
                        </div>
                    `);
                    return;
                }

                if (minAgeDays < 0 || maxAgeYears < 0) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°ï¼</p>
                        </div>
                    `);
                    return;
                }

                // è®¡ç®—å‡ºç”Ÿæ—¥æœŸåŒºé—´
                const minAgeRange = calculateBirthDateRangeFromDays(minAgeDays, referenceDate);
                const maxAgeRange = calculateBirthDateRange(maxAgeYears, referenceDate);

                // ç¬¦åˆæ¡ä»¶çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´
                validBirthStart = maxAgeRange.earliest; // æœ€å¤§å¹´é¾„çš„æœ€æ—©å‡ºç”Ÿæ—¥æœŸ
                validBirthEnd = minAgeRange.latest;     // æœ€å°å¹´é¾„çš„æœ€æ™šå‡ºç”Ÿæ—¥æœŸ

                // è®¡ç®—è¾¹ç•Œæ—¥æœŸ
                const boundaryDates = calculateBoundaryDates(minAgeDays, maxAgeYears, referenceDate, 'day');

                resultHTML = `
                    <div class="result-title">
                        <span class="status-icon">ğŸ“Š</span>
                        åˆ†æç»“æœï¼ˆå¤©æ•°æ¨¡å¼ï¼‰
                    </div>
                    <div class="result-detail">
                        <p><strong>è®¡ç®—åŸºå‡†æ—¥æœŸï¼š</strong><span class="highlight">${formatDate(referenceDate)}</span></p>
                        <p><strong>äº§å“å¹´é¾„è¦æ±‚ï¼š</strong><span class="highlight">${minAgeDays}å¤©ï¼ˆå«ï¼‰- ${maxAgeYears}å‘¨å²ï¼ˆå«ï¼‰</span></p>
                        
                        <hr class="divider">
                        
                        <div class="boundary-dates">
                            <p style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ¯ å…³é”®è¾¹ç•Œæ—¥æœŸ
                            </p>
                            <div class="boundary-item min">
                                <div class="boundary-icon">ğŸ‚</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å°è´­ä¹°å¹´é¾„</div>
                                    <div class="boundary-age-detail">å¤©æ•°ï¼š${minAgeDays}å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.minBoundaryDate)}ï¼ˆæˆ–æ›´æ—©ï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ—©å‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} å·²æ»¡ ${minAgeDays} å¤©ï¼Œç¬¦åˆæœ€å°æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                            <div class="boundary-item max">
                                <div class="boundary-icon">ğŸ¯</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å¤§è´­ä¹°å¹´é¾„ï¼ˆé€»è¾‘1ï¼‰</div>
                                    <div class="boundary-age-detail">å‘¨å²ï¼š${maxAgeYears}å²364å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.maxBoundaryDate1)}ï¼ˆæˆ–æ›´æ™šï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ™šå‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} æœªæ»¡ ${maxAgeYears + 1} å‘¨å²ï¼Œç¬¦åˆæœ€å¤§æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                            <div class="boundary-item max">
                                <div class="boundary-icon">ğŸ¯</div>
                                <div class="boundary-content">
                                    <div class="boundary-title">æœ€å¤§è´­ä¹°å¹´é¾„ï¼ˆé€»è¾‘2ï¼‰</div>
                                    <div class="boundary-age-detail">å‘¨å²ï¼š${maxAgeYears}å²0å¤©</div>
                                    <div class="boundary-date">å‡ºç”Ÿæ—¥æœŸï¼š${formatDateChinese(boundaryDates.maxBoundaryDate2)}ï¼ˆæˆ–æ›´æ™šï¼‰</div>
                                    <div class="boundary-desc">
                                        åœ¨æ­¤æ—¥æœŸæˆ–æ›´æ™šå‡ºç”Ÿçš„äººï¼Œåœ¨ ${formatDate(referenceDate)} åˆšå¥½åˆ°è¾¾ ${maxAgeYears} å‘¨å²ï¼Œç¬¦åˆæœ€å¤§æŠ•ä¿å¹´é¾„è¦æ±‚ã€‚
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="logic-comparison">
                            <div class="logic-comparison-title">
                                <span class="icon">ğŸ“</span>
                                ä¸¤ç§é€»è¾‘å¯¹æ¯”è¯´æ˜
                            </div>
                            <div class="logic-comparison-desc">
                                <p><strong>é€»è¾‘1ï¼š</strong>ä¸¥æ ¼éµå¾ªä¿é™©è¡Œä¸šæ ‡å‡†ï¼Œæœ€å¤§å¹´é¾„ä¸º"æœªæ»¡ä¸‹ä¸€å‘¨å²"ï¼Œå³ ${maxAgeYears} å² 364 å¤©ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„æ ‡å‡†ã€‚</p>
                                <p><strong>é€»è¾‘2ï¼š</strong>å°†æœ€å¤§å¹´é¾„ç†è§£ä¸º"åˆšå¥½æ»¡ ${maxAgeYears} å‘¨å²"ï¼Œå³ ${maxAgeYears} å² 0 å¤©ã€‚æŸäº›äº§å“å¯èƒ½é‡‡ç”¨æ­¤æ ‡å‡†ã€‚</p>
                                <p><strong>æ¨èä½¿ç”¨ï¼š</strong>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¿é™©è¡Œä¸šé‡‡ç”¨<strong>é€»è¾‘1</strong>ä½œä¸ºæ ‡å‡†è®¡ç®—æ–¹æ³•ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒå…·ä½“ä¿é™©äº§å“çš„æ¡æ¬¾è¯´æ˜ã€‚</p>
                            </div>
                        </div>
                        
                        <hr class="divider">
                        
                        <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid #e0e0e0;">
                            <p style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ“… ç¬¦åˆæŠ•ä¿æ¡ä»¶çš„å‡ºç”Ÿæ—¥æœŸåŒºé—´ï¼ˆåŸºäºé€»è¾‘1ï¼‰
                            </p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #667eea;">
                                <p style="font-size: 18px; font-weight: bold; color: #667eea; text-align: center; line-height: 1.8;">
                                    ${formatDate(validBirthStart)} è‡³ ${formatDate(validBirthEnd)}
                                </p>
                            </div>
                            <p style="margin-top: 15px; color: #666; font-size: 14px; line-height: 1.6;">
                                <strong>è¯´æ˜ï¼š</strong>å‡ºç”Ÿæ—¥æœŸåœ¨æ­¤åŒºé—´å†…ï¼ˆå«è¾¹ç•Œæ—¥æœŸï¼‰çš„æŠ•ä¿äººï¼Œåœ¨ ${formatDate(referenceDate)} è¿™ä¸€å¤©å¹´é¾„æ»¡ ${minAgeDays} å¤©ä¸”ä¸è¶…è¿‡ ${maxAgeYears} å‘¨å²ã€‚
                            </p>
                        </div>

                        <hr class="divider">

                        <div class="age-range-display">
                            <p style="font-size: 15px; font-weight: bold; color: #333; margin-bottom: 15px;">
                                ğŸ” è¯¦ç»†å¹´é¾„åŒºé—´åˆ†è§£
                            </p>
                            <div class="range-item">
                                <span class="range-label">æœ€å°å¹´é¾„ï¼ˆ${minAgeDays}å¤©ï¼‰ï¼š</span>
                                <span class="range-value">${formatDate(minAgeRange.earliest)}</span>
                            </div>
                            <div class="range-item">
                                <span class="range-label">æœ€å¤§å¹´é¾„ï¼ˆ${maxAgeYears}å‘¨å²ï¼‰ï¼š</span>
                                <span class="range-value">${formatDate(maxAgeRange.earliest)} ~ ${formatDate(maxAgeRange.latest)}</span>
                            </div>
                        </div>
                `;
            }

            // å¦‚æœå¡«å†™äº†æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸï¼Œè¿›è¡Œæ ¡éªŒ
            if (birthDateInput) {
                const birthDate = new Date(birthDateInput);
                
                // æ ¡éªŒæ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
                if (isNaN(birthDate.getTime())) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®ï¼</p>
                        </div>
                    `);
                    return;
                }

                // æ£€æŸ¥å‡ºç”Ÿæ—¥æœŸæ˜¯å¦åœ¨æœªæ¥
                if (birthDate > referenceDate) {
                    showResult(resultDiv, 'error', `
                        <div class="result-title">
                            <span class="status-icon">âŒ</span>
                            è¾“å…¥é”™è¯¯
                        </div>
                        <div class="result-detail">
                            <p>æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šäºè®¡ç®—åŸºå‡†æ—¥æœŸï¼</p>
                        </div>
                    `);
                    return;
                }

                let isValid, ageDisplay;
                
                if (currentMode === 'year') {
                    const currentAge = calculateAge(birthDate, referenceDate);
                    isValid = currentAge >= minAge && currentAge <= maxAge;
                    ageDisplay = `${currentAge}å‘¨å²`;
                } else {
                    // ä¿®å¤å¤©æ•°æ¨¡å¼æ ¡éªŒé€»è¾‘ - å‚è€ƒ"å¤©æ•°æ ¡éªŒå‚è€ƒ.html"
                    const currentAgeDays = calculateAgeInDays(birthDate, referenceDate);
                    const currentAgeYears = calculateAge(birthDate, referenceDate);
                    
                    // å°†æœ€å¤§å¹´é¾„è½¬æ¢ä¸ºå¤©æ•°è¿›è¡Œæ¯”è¾ƒï¼ˆä¸å‚è€ƒæ–‡ä»¶é€»è¾‘ä¸€è‡´ï¼‰
                    const minAgeDays = parseInt(document.getElementById('minAgeDays').value);
                    const maxAgeYears = parseInt(document.getElementById('maxAgeDays').value);
                    const maxAgeDays = convertToDays(maxAgeYears, 'years', referenceDate);
                    
                    // å…³é”®ä¿®å¤ï¼šä½¿ç”¨å¤©æ•°è¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸æ˜¯æ··åˆä½¿ç”¨å¤©æ•°å’Œå‘¨å²
                    isValid = currentAgeDays >= minAgeDays && currentAgeDays <= maxAgeDays;
                    ageDisplay = `${currentAgeDays}å¤©ï¼ˆ${currentAgeYears}å‘¨å²ï¼‰`;
                }

                resultHTML += `
                    <hr class="divider">
                    
                    <div style="background: ${isValid ? '#d4edda' : '#f8d7da'}; padding: 20px; border-radius: 8px; border: 2px solid ${isValid ? '#28a745' : '#dc3545'};">
                        <p style="font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px;">
                            ğŸ‘¤ æŠ•ä¿äººå¹´é¾„æ ¡éªŒ
                        </p>
                        <p><strong>æŠ•ä¿äººå‡ºç”Ÿæ—¥æœŸï¼š</strong><span class="highlight">${formatDate(birthDate)}</span></p>
                        <p><strong>åœ¨ ${formatDate(referenceDate)} çš„å¹´é¾„ï¼š</strong><span class="highlight">${ageDisplay}</span></p>
                        <div class="conclusion" style="background: ${isValid ? 'rgba(40, 167, 69, 0.15)' : 'rgba(220, 53, 69, 0.15)'}; color: ${isValid ? '#155724' : '#721c24'}; border-left: 4px solid ${isValid ? '#28a745' : '#dc3545'};">
                            ${isValid ? 
                                `âœ… è¯¥æŠ•ä¿äººç¬¦åˆæŠ•ä¿æ¡ä»¶` : 
                                `âŒ è¯¥æŠ•ä¿äººä¸ç¬¦åˆæŠ•ä¿æ¡ä»¶`
                            }
                        </div>
                    </div>
                `;
            }

            resultHTML += `</div>`;

            showResult(resultDiv, 'info', resultHTML);
        }

        /**
         * æ¸…ç©ºæ‰€æœ‰è¾“å…¥å’Œç»“æœ
         */
        function clearAll() {
            document.getElementById('minAge').value = '';
            document.getElementById('maxAge').value = '';
            document.getElementById('minAgeDays').value = '';
            document.getElementById('maxAgeDays').value = '';
            document.getElementById('birthDate').value = '';
            document.getElementById('customDateToggle').checked = false;
            document.getElementById('customDateContainer').style.display = 'none';
            document.getElementById('result').style.display = 'none';
        }
    </script>
</body>
</html>